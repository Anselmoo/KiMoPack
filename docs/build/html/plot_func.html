

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>KiMoPack - Functions &mdash; KiMoPack 6.5.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Function Index" href="genindex.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> KiMoPack
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Main_tasks.html">Main Tasks overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Opening.html">Opening of data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Shaping.html">Shaping of Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plotting.html">Plotting functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fitting.html">Fitting, Parameter optimization and Error estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Comparing.html">Comparative plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="Saving.html">Data Export and Project Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Function Index</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">KiMoPack - Functions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">KiMoPack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>KiMoPack - Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/plot_func.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="kimopack-functions">
<h1>KiMoPack - Functions<a class="headerlink" href="#kimopack-functions" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="plot_func.TA">
<em class="property">class </em><code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">TA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'\t'</span></em>, <em class="sig-param"><span class="n">decimal</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">index_is_energy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transpose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sort_indexes</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">divide_times_by</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">shift_times_by</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_wave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="plot_func.TA.Background">
<code class="sig-name descname">Background</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lowlimit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">uplimit</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">use_median</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">correction</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Background" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the background correction. In general it for each measured
wavelength averages the values from ‘lowlimit’ to ‘uplimit’ and
subtracts it from the data. It rund on the object (global) or if
given a specific ds local.
The low and uplimit can be set anywhere to substract any background.
It is important to note that many problems during measurements might
be visible in the data before time zero. So I recommend to first
plot without background correction and only after this inspection
apply the background correction.
The fit function has its own way to calculcate and apply a background
That could be used instead (but making the fit less stable)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lowlimit</strong> (<em>None</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – this is the lower limit from which the average (or median) is taken
(Default) is None, in which case the lower limit of the data is used.</p></li>
<li><p><strong>uplimit</strong> (<em>None</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – this is the upper limit until which the average (or median) is taken
(Default) is -1 (usually ps), in which case the lower limit of the data is used.</p></li>
<li><p><strong>use_median</strong> (<em>bool</em><em>, </em><em>optional</em>) – the Median is a more outlier resistant metric in comparision to
the Mean (Average). However the values are not quite as close
to the distribution center in case of very few values. False
(Default) means the Mean is used</p></li>
<li><p><strong>ds</strong> (<em>None</em><em> or </em><em>DataFrame</em><em>, </em><em>optional</em>) – if None (Default) the internal Dataframe self.ds is used,
otherwise the pandas DataFrame ds is corrected and returned</p></li>
<li><p><strong>correction</strong> (<em>None</em><em> or </em><em>DataFrame</em><em>, </em><em>optional</em>) – this is the correction applied. It must be a DataFrame with
the same numbers of columns (spectral points) as the used ds</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>if the object self has the name “ta”</p>
<p>typical useage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Background</span><span class="p">()</span>
</pre></div>
</div>
<p>specify inegrated are to - inf (Default) up to -0.5ps and use the Median for computation</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Background</span><span class="p">(</span><span class="n">uplimit</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_median</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Compare_DAC">
<code class="sig-name descname">Compare_DAC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spectra</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">separate_plots</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Compare_DAC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Compare_DAC" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a convenience function to plot multiple extracted spectra
(DAS or species associated) into the same figure or into a separate figure
each. Other should be ta.plot_func objects (loaded or copied). By
standard it plots all into the same window. If all project have the same
number of components one can activate “separate_plots” and have each
separated (in the order created in the projects).</p>
<p>The “Spectra” parameter allows as before the inclusion of an external
spectrum. Others is optional and I use this function often to compare
species associated spectra with one or multiple steady state spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>TA object</em><em> or </em><em>list of those</em><em>, </em><em>optional</em>) – should be ta.plot_func objects (loaded or copied) and is what
is plotted against the data use a list [ta1,ta2,… ] or generate this
list using the Gui function. See section <a class="reference internal" href="Opening.html#opening-multiple-files"><span class="std std-ref">Opening multiple files</span></a> in
the documentation</p></li>
<li><p><strong>spectra</strong> (<em>None</em><em> or </em><em>DataFrame</em><em>, </em><em>optional</em>) – If an DataFrame with the wavelength as index is provided, Then the spectra of each column
is plotted into the differential spectra 1:1 and the column names are used in the legend
Prior scaling is highly suggested. These spectra are not (in general) scaled with the
norm window. (see examples)</p></li>
<li><p><strong>separate_plots</strong> (<em>bool</em><em>, </em><em>optional</em>) – True or False (Default), separate plots is the switch that decides if a axis or
multiple axis are used. This option will result in a crash unless all objects have the
same number of DAS/SAS components</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plot_func</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;test1.hdf5&#39;</span><span class="p">)</span> <span class="c1">#open the original project,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">this</span> <span class="n">MUST</span> <span class="n">contain</span> <span class="n">a</span> <span class="n">fit</span><span class="p">,</span> <span class="n">otherwise</span> <span class="n">this</span> <span class="n">will</span> <span class="k">raise</span> <span class="n">an</span> <span class="n">error</span>
</pre></div>
</div>
<p>Now open a bunch of other projects to compare against,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#compare in a single window</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_projects</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">(</span><span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;file1.hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;file2.hdf5&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_DAC</span><span class="p">(</span><span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#comprare in separate windows,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#the other projects must have the same number of components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_DAC</span><span class="p">(</span><span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">,</span> <span class="n">separate_plots</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the DAC to an external spectrum</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ext_spec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Ascii_spectrum.dat&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_DAC</span><span class="p">(</span><span class="n">spectra</span> <span class="o">=</span> <span class="n">ext_spec</span><span class="p">)</span> <span class="c1">#compare just the current solution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_DAC</span><span class="p">(</span><span class="n">spectra</span> <span class="o">=</span> <span class="n">ext_spec</span><span class="p">,</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">)</span> <span class="c1">#compare multiple</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Compare_at_time">
<code class="sig-name descname">Compare_at_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rel_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">other</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fitted</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">norm_window</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_width_percent</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spectra</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_and_fit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">print_click_position</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Compare_at_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Compare_at_time" title="Permalink to this definition">¶</a></dt>
<dd><p>This function plots multiple spectra into the same figure at a given rel_time (timepoints) and
allows for normalization. Very useful to compare the spectra for different solvents or quenchers, or
e.g. different fits. The ta.time_width_percent parameter defines if this is a
single time (if time_width_percent = 0) or an integrated window.
Only “rel_time” is a mandatory, the rest can be taken from the original project (ta).</p>
<p>The normalization is realized by giving a norm_window
at which the intensity in the triggering object is integrated (in ta.Compare_at_time(other..)
“ta” is the triggering object. The in each of the other curves the same window is
integrated and the curve scaled by this value. Important to note is that this window
does not need to be in the plot. e.g. the normalization can be done at a different time.</p>
<p>Very often one would like to compare the measured spectra at a certain
time to an external spectrum (e.g. spectro-electro-chemistry or steady
state absorption). This can be done by loading a specific spectrum into
a DataFrame and handing this data Frame to the comparision function. The
function can also be used to plot e.g. the measured spectra vs. an
external spectrum without giving any “other” Projects. (very useful for
comparisions).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rel_time</strong> (<em>float</em><em> or </em><em>list/vector</em><em> (</em><em>of floats</em><em>)</em>) – Specify the times where to plot, single value or list/vector of values.
For each entry in rel_time a spectrum is plotted.
If time_width_percent=0 (Default) the nearest measured
timepoint is chosen. For other values see parameter “time_width_percent”.</p></li>
<li><p><strong>other</strong> (<em>TA object</em><em> or </em><em>list of those</em><em>, </em><em>optional</em>) – should be ta.plot_func objects (loaded or copied) and is what
is plotted against the data use a list [ta1,ta2,… ] or generate this
list using the Gui function. See section <a class="reference internal" href="Opening.html#opening-multiple-files"><span class="std std-ref">Opening multiple files</span></a> in
the documentation</p></li>
<li><p><strong>fitted</strong> (<em>bool</em><em>, </em><em>optional</em>) – True/False (Default) - use fitted data instead of raw data.
If True, the fitted datapoints (without interpolation) are used.
This is intended for comparing e.g. different fits</p></li>
<li><p><strong>norm_window</strong> (<em>None</em><em> or </em><em>list/vector</em><em> (</em><em>with 4 floats</em><em>)</em><em>, </em><em>optional</em>) – norm_window Give a list/tupel/vector with 4 entries in the order
[Start - time, End - time, Start - wavelength, End - Wavelength],
see section  <a class="reference internal" href="Comparing.html#normalization-and-scaling"><span class="std std-ref">Normalization and Scaling</span></a>  in the documentation.
If None (Default) no normalization is done.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – linewidth to be used for plotting</p></li>
<li><p><strong>time_width_percent</strong> (<em>None</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – “rel_time” and “time_width_percent” work together for creating spectral plots at
specific timepoints. For each entry in rel_time a spectrum is plotted.
If however e.g. time_width_percent=10 the region between the timepoint closest
to <span class="math notranslate nohighlight">\(timepoint+0.1xtimepoint´ and :math:\)</span> is averaged and shown
(and the legend adjusted accordingly). If None (Default) is given, the value is
taken from the triggering object (self.time_width_percent) This is particularly useful for the densly
sampled region close to t=0. Typically for a logarithmic recorded kinetics, the
timepoints at later times will be further appart than 10 percent of the value,
but this allows to elegantly combine values around time=0 for better statistics.
This averaging is only applied for the plotting function and not for the fits.</p></li>
<li><p><strong>spectra</strong> (<em>None</em><em> or </em><em>DataFrame</em><em>, </em><em>optional</em>) – If an DataFrame with the wavelength as index is provided, Then the spectra of each column
is plotted into the differential spectra 1-1 and the column names are used in the legend
Prior scaling is highly suggested. These spectra are not (in general) scaled with the
norm window. (see examples).</p></li>
<li><p><strong>data_and_fit</strong> (<em>bool</em><em>, </em><em>optional</em>) – True or False (Default), choose if for the Fitted plot the raw data of the
other projects is to be plotting in addition to the fitted line. For False (Default)
Only the fit is plotted.</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
<li><p><strong>print_click_position</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True then the click position is printed for the spectral plots</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plot_func</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s2">&quot;test1.hdf5&quot;</span><span class="p">)</span> <span class="c1">#open the original project</span>
</pre></div>
</div>
<p>Now open a bunch of other porjects to comare against</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">other_projects</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">(</span><span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;file1.SIA&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.SIA&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Typical use is compare the raw data without normalization at 1ps and 6ps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_time</span><span class="p">(</span><span class="n">rel_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the fit withput normalization at 1ps and 6ps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_time</span><span class="p">(</span><span class="n">rel_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">,</span> <span class="n">fitted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare with normalization window between 1ps and 2ps and 400nm and 450nm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm_window</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">450</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_time</span><span class="p">(</span><span class="n">rel_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">,</span> <span class="n">norm_window</span> <span class="o">=</span> <span class="n">norm_window</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the spectrum at 1ps and 6ps with an external spectrum.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ext_spec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Ascii_spectrum.dat&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_time</span><span class="p">(</span><span class="n">rel_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">spectra</span> <span class="o">=</span> <span class="n">ext_spec</span><span class="p">)</span>
</pre></div>
</div>
<p>Use example -  Often there are a lot of different measurements to
compare at multiple time. The normlization is performed at the ground state bleach
460 nm and early in time. Then it is better to make a new plot for each
timepoint. The normalization window stays fixed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="c1">#make some space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_window</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">450</span><span class="p">,</span><span class="mi">470</span><span class="p">]</span> <span class="c1">#define window in ground state bleach</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">]:</span> <span class="c1">#iterate over the wavelength</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_time</span><span class="p">(</span><span class="n">rel_time</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">,</span> <span class="n">norm_window</span> <span class="o">=</span> <span class="n">norm_window</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Compare_at_wave">
<code class="sig-name descname">Compare_at_wave</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rel_wave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">other</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fitted</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">norm_window</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_and_fit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">scale_type</span><span class="o">=</span><span class="default_value">'symlog'</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Compare_at_wave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Compare_at_wave" title="Permalink to this definition">¶</a></dt>
<dd><p>This function plots multiple kinetics into the same figure at one or
multiple given wavelength (rel_wave) and  allows for
<a class="reference internal" href="Comparing.html#normalization-and-scaling"><span class="std std-ref">Normalization and Scaling</span></a> Very useful to compare the
kinetics for different quencher concentrations or pump powers,
or e.g. different fits. The parameter width or the general self.wavelength_bin
which is used if width is None (Default) defines the width of
the spectral window that is integrated and shown.</p>
<p>A normalization window can be given at which all the plotted curves are normalized to.
This window does not have to be in the plotted region. See <a class="reference internal" href="Comparing.html#normalization-and-scaling"><span class="std std-ref">Normalization and Scaling</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rel_wave</strong> (<em>float</em><em> or </em><em>list/vector</em><em> (</em><em>of floats</em><em>)</em>) – Specify the wavelength where to plot the kinetics, single value or
list/vector of values (only mandatory entry) For each entry in
rel_wave a kinetic is plotted. ‘rel_wave’ and ‘width’
(in the object called ‘wavelength_bin’ work together for the creation
of kinetic plots. At each selected wavelength the data between
wavelength+width/2 and wavelength-width/2 is averaged
for each timepoint</p></li>
<li><p><strong>other</strong> (<em>TA object</em><em> or </em><em>list of those</em><em>, </em><em>optional</em>) – should be ta.plot_func objects (loaded or copied) and is what
is plotted against the data use a list [ta1,ta2,… ] or generate this
list using the Gui function. See section <a class="reference internal" href="Opening.html#opening-multiple-files"><span class="std std-ref">Opening multiple files</span></a> in
the documentation</p></li>
<li><p><strong>fitted</strong> (<em>bool</em><em>, </em><em>optional</em>) – True/False (Default) - use fitted data instead of raw data.
If True, the fitted datapoints (without interpolation) are used.
This is intended for comparing e.g. different fits</p></li>
<li><p><strong>norm_window</strong> (<em>None</em><em> or </em><em>list/vector</em><em> (</em><em>with 4 floats</em><em>)</em><em>, </em><em>optional</em>) – norm_window Give a list/tupel/vector with 4 entries in the order
[Start - time, End - time, Start - wavelength, End - Wavelength],
see section <a class="reference internal" href="Comparing.html#normalization-and-scaling"><span class="std std-ref">Normalization and Scaling</span></a> in the documentation.
If None (Default) no normalization is done.</p></li>
<li><p><strong>width</strong> – Specify the width above and below the given wavelength that is
integrated as window. If left to (Default) “None” the value from ta is
used.</p></li>
<li><p><strong>data_and_fit</strong> (<em>bool</em><em>, </em><em>optional</em>) – True or False (Default), choose if for the Fitted plot the raw data of the
other projects is to be plotting in addition to the fitted line. For False (Default)
Only the fit is plotted.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – linewidth to be used for plotting</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
<li><p><strong>Scale_type</strong> (<em>None</em><em> or </em><em>str</em>) – is a general setting that can influences what time axis will be used for the plots.
“symlog” (linear around zero and logarithmic otherwise) “lin” and “log” are valid options.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plot_func</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;test1.hdf5&#39;</span><span class="p">)</span> <span class="c1">#open the original project</span>
</pre></div>
</div>
<p>Now open a bunch of other projects to compare against</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">other_projects</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">(</span><span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;file1.SIA&#39;</span><span class="p">,</span> <span class="s1">&#39;file2.SIA&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Typical use:
Compare the raw data without normalization at 400 nm and 500 nm</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_wave</span><span class="p">(</span><span class="n">rel_wave</span> <span class="o">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the quality of the fit data without normalization at 400 nm and 500 nm</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_wave</span><span class="p">(</span><span class="n">rel_wave</span> <span class="o">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">,</span> <span class="n">fitted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare with normalization window between 1ps and 2ps and 400nm and 450nm</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm_window</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">450</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_wave</span><span class="p">(</span><span class="n">rel_wave</span> <span class="o">=</span> <span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">,</span> <span class="n">norm_window</span> <span class="o">=</span> <span class="n">norm_window</span><span class="p">)</span>
</pre></div>
</div>
<p>Use example: Often there are a lot of different measurements to
compare at multiple wavelength. The normlization is performed at the ground state bleach
460 nm and early in time. Then it is better to make a new plot for each
wavelength. The normalization window stays fixed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span> <span class="c1">#make some space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_window</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">450</span><span class="p">,</span><span class="mi">470</span><span class="p">]</span> <span class="c1">#define window in ground state bleach</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">700</span><span class="p">]:</span> <span class="c1">#iterate over the wavelength</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ta</span><span class="o">.</span><span class="n">Compare_at_wave</span><span class="p">(</span><span class="n">rel_wave</span> <span class="o">=</span> <span class="n">wave</span><span class="p">,</span> <span class="n">others</span> <span class="o">=</span> <span class="n">other_project</span><span class="p">,</span> <span class="n">norm_window</span> <span class="o">=</span> <span class="n">norm_window</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Copy">
<code class="sig-name descname">Copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Copy" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a deep copy of the object.</p>
<p class="rubric">Example</p>
<p>&gt;&gt;&gt;ta=plot_func.TA(‘testfile.hdf5’) #open a project
&gt;&gt;&gt;ta1=ta.Copy() #make a copy for some tests or a differnet fit</p>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Cor_Chirp">
<code class="sig-name descname">Cor_Chirp</code><span class="sig-paren">(</span><em class="sig-param">chirp_file=None, path=None, shown_window=[-1, 1], fitcoeff=None, max_points=40, cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Cor_Chirp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Cor_Chirp" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cor_Chirp</em> is a powerful Function to correct for a different arrival times of
different wavelength (sometimes call chirp).
In general if a file is opened for the first time this function is opening
a plot and allows the user to select a number of points, which are then
approximated with a 4th order polynomial and finally to select a point
that is declared as time zero. The observed window as well as the intensities
and the colour map can be chosen to enable a good correction. Here a fast
iterating colour scheme such as “prism” is often a good choice. In all of the
selections a left click selects, a right click removes the last point and
a middle click (sometime appreviated by clicking left and right together)
finishes the selection. If no middle click exists, the process
automatically ends after max_points (40 preset).</p>
<p>After the first run the polynom is stored in self.fitcoeff, a new matrix
calculated from self.ds_ori that is stored as self.ds and a file stored in the
same location as the original data. The second time the function <em>Cor_Chirp</em> is
run the function will find the file and apply the chirp correction automatically.</p>
<p>If one does want to re-run the chirp correction the function <em>Man_Chirp</em> does
not look for this file, but creates after finishing a new file.</p>
<p>Alternatively the polynom or a filename can be given that load a chirp correction
(e.g. from a different run with the same sample).
The function <em>Cor_Chirp</em> selects in the order:</p>
<p># “fitcoeff”
# “other files”
# “stored_file”
# call Man_Chirp (clicking by hand)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chirp-file</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – <p>If a raw file was read(e.g. “data.SIA”) and the chirp correction was
completed, a file with the attached word “chirp” is created and
stored in the same location. (“data_chirp.dat”) This file contains
the 5 values of the chirp correction. By selecting such a file
(e.g. from another raw data) a specific chirp is applied. If a
specific name is given with <strong>chirp_file</strong> (and optional <strong>path</strong>)
then this file is used.</p>
<p>GUI</p>
<p>The word <em>‘gui’</em> can be used instead of a filename to open a gui that
allows the selection of a chrip file</p>
</p></li>
<li><p><strong>path</strong> (<em>str</em><em> or </em><em>path object</em><em> (</em><em>optional</em><em>)</em>) – if path is a string without the operation system dependent separator, it is treated as a relative path,
e.g. data will look from the working directory in the sub director data. Otherwise this has to be a
full path in either strong or path object form.</p></li>
<li><p><strong>shown_window</strong> (<em>list</em><em> (</em><em>with two floats</em><em>)</em><em>, </em><em>optional</em>) – Defines the window that is shown during chirp correction. If the t=0 is not visible, adjust this parameter
to suit the experiment. If problems arise, I recomment to use Plot_Raw to check where t=0 is located</p></li>
<li><p><strong>fitcoeff</strong> (<em>list</em><em> or </em><em>vector</em><em> (</em><em>5 floats</em><em>)</em><em>, </em><em>optional</em>) – One can give a vector/list with 5 numbers representing the parameter
of a 4th order polynomial (in the order
<span class="math notranslate nohighlight">\((a4*x^4 + a3*x^3+a2*x^2+a1*x1+a0)\)</span>. The chirp parameter are
stored in ta.fitcoeff and can thus be used in other TA objects. This
vector is also stored with the file and automatically applied during
re-loading of a hdf5-object</p></li>
<li><p><strong>max_points</strong> (<em>int</em><em>, </em><em>optional</em>) – Default = 40 max numbers of points to use in Gui selection. Useful option in case no middle mouse button
is available. (e.g. touchpad)</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib colourmap</em><em>, </em><em>optional</em>) – <p>Colourmap to be used for the chirp correction. While there is a large selection here I recommend to choose
a different map than is used for the normal 2d plotting.</p>
<p>cm.prism (Default) has proofen to be very usefull</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>In most cases:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plot_func</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;test1.SIA&#39;</span><span class="p">)</span> <span class="c1">#open the original project,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Cor_Chirp</span><span class="p">()</span>
</pre></div>
</div>
<p>Selecting a specific correction</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; ta.Cor_Chirp(‘gui’)
&gt;&gt;&gt; ta.Cor_Chirp(chirp_file = &#39;older_data_chirp.dat&#39;)
&gt;&gt;&gt; #use the coefficients from a different project
&gt;&gt;&gt; ta.Cor_Chirp(fitcoeff = ta_old.fitcoeff) #use the coefficients from a different project
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Filter_data">
<code class="sig-name descname">Filter_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cut_bad_times</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">replace_bad_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">value</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">uppervalue</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lowervalue</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Filter_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Filter_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Filteres the data by applying hard replacements. if both replace_bad_values and
cut_bad_times are false or None, the times above “value” are replaced by zero</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>float</em><em>, </em><em>optional</em>) – all values above this (absolute) value are considered to be corrupted. (Default 20) as classically the setup
reports optical DEnsity, an OD of 20 would be far above the typically expected
OD 1e-3. Pascher instrument software uses a value of 21 to indicate an error.</p></li>
<li><p><strong>uppervalue</strong> (<em>float</em><em>, </em><em>optional</em>) – all values above this number are considered to be corrupted. (Default 20) as classically the setup
reports optical DEnsity, an OD of 20 would be far above the typically expected
OD 1e-3. Pascher instrument software uses a value of 21 to indicate an error.</p></li>
<li><p><strong>lowervalue</strong> (<em>float</em><em>, </em><em>optional</em>) – all values below this number are considered to be corrupted. (Default -20) as classically the setup
reports optical DEnsity, an OD of -20 would be far above the typically expected
OD 1e-3. Pascher instrument software uses a value of 21 to indicate an error.</p></li>
<li><p><strong>replace_bad_values</strong> (<em>None of float</em><em>, </em><em>optional</em>) – values above the treshold are replaced with this value. Ignored of None (Default)</p></li>
<li><p><strong>= bool</strong> (<em>cut_bad_times</em>) – True (Default) removes the whole time where this is true</p></li>
<li><p><strong>optional</strong> – True (Default) removes the whole time where this is true</p></li>
</ul>
</dd>
</dl>
<p>the value is the upper bound. everything
above will be filtered. Standard is to drop the rows(=times) where something went wrong</p>
<p class="rubric">Examples</p>
<p>typical usage</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plotfunc</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;testfile.SIA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Filter_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Filter_data</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#to filter times with at least one point with OD 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Fit_Global">
<code class="sig-name descname">Fit_Global</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">confidence_level</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_ampgo</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fit_chirp</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fit_chirp_iterations</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">multi_project</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">unique_parameter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dump_paras</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_spectra</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Fit_Global"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Fit_Global" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is performing a global fit of the data. As embedded object it uses
the parameter control options of the lmfit project as an essential tool.
(my thanks to Matthew Newville and colleagues for creating this phantastic tool)
[M. Newville, T. Stensitzki, D. B. Allen, A. Ingargiola, 2014. DOI: 10.5281/ZENODO.11813.].
The what type of fitting is performed is controlled by setting of the parameter here.</p>
<dl class="simple">
<dt>The general fitting follows this routine:</dt><dd><ol class="arabic simple">
<li><p>create a copy of the Data-Matrix self.ds is created with the shaping parameters</p></li>
<li><p>Then a Matrix is created that represents the fractional population of each species
(or processes in case of the paral model).
This Matrix contains one entry for each timepoint and represents the kinetic model
based upon the starting parameter. (see below for a description of the models).
This model formation can by done by using a build in or a user supplied function.
(handled in the function “pf.build_c”)
-&gt; If an ext_spectra is provided this its intensity is substacted from the matrix (only for external models)</p></li>
<li><p>Then the process/species associated spectra for each of the species is calculated
using the linalg.lstsq algorithm from numpy
(<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html">https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html</a>)</p></li>
<li><p>From the convoluted calculated species concentrations and spectra a calculated matrix
is formed (handled in the function “pf.fill_int”)</p></li>
<li><p>The difference between calculated and measured spectra is calculated, point-wise squared
and summed together. (function “err_func” or “err_func_multi” if multiple datasets are fitted)</p></li>
<li><p>This difference is minimized by iterating 2-4 with changing parameters using an
optimization algorithm (generally nelder-mead simplex)</p></li>
<li><p>Finally in a last run of 2-5 the final spectra are calculated (using the “final” flag)
and the optimized parameter, the matrixes
(“A”-measured, “AC” - calculated, “AE” - linear error),
spectra (always called “DAS”) the concentrations (called “c”)
are written in the dictionary “ta.re” together with a few result representations
and other fit outputs. The optimized parameter are also written into ta.par_fit
(as an parameter object) that can be re-used as input into further optimization steps.</p></li>
</ol>
</dd>
</dl>
<p>All mandatory parameters are in general taken from the internal oject (self) The optional parameter control the behaviour of the fitting function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par</strong> (<em>lmfit parameter oject</em><em>, </em><em>optional</em>) – Here another parameter object could be given,overwriting the (Default is self.par)</p></li>
<li><p><strong>mod</strong> (<em>str</em><em> or </em><em>function</em><em>, </em><em>optional</em>) – Give a extra model selection (Default uses self.mod)
internal modells: ‘paral’,’exponential’,’consecutive’,’full_consecutive’
see also <a class="reference internal" href="#plot_func.build_c" title="plot_func.build_c"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_func.build_c()</span></code></a> and <a class="reference internal" href="#plot_func.err_func" title="plot_func.err_func"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_func.err_func()</span></code></a></p></li>
<li><p><strong>confidence_level</strong> (<em>None</em><em> or </em><em>float</em><em> (</em><em>0.5-1</em><em>)</em><em>, </em><em>optional</em>) – If this is changed from None (Default) to a value between 0.5 and 1 the code will
try to calculate the error of the parameter for the fit. For each parameter that
can vary a separate optimization is     performed, that attempts to find the upper
and lower bound at which the total error of the re-optimized globally fitted results
reaches the by F-statistics defined confidence bound. See <a class="reference internal" href="#plot_func.s2_vs_smin2" title="plot_func.s2_vs_smin2"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_func.s2_vs_smin2()</span></code></a> for details
on how this level is determined. Careful, this option might run for very long time.
Meaning that it typically takes 50 optimization per variable parameter (hard coded limit 200)
The confidence level is to be understood that it defines the e.g. 0.65 * 100% area that the
parameter with this set of values is within this bounds.</p></li>
<li><p><strong>use_ampgo</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) is False
Changes the optimizer from a pure Nelder mead to Ampgo with a local Nelder Mead.
For using this powerfull tool all parameter need to have a “min” and a “max” set.
Typically takes 10-40x longer than a standard optimization, but can due to its
tunneling algorithm more reliably find global minima.
see:https://lmfit.github.io/lmfit-py/fitting.html for further details</p></li>
<li><p><strong>fit_chirp</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) is False
a powerful optimization of the chirp parameter. For this to work the data
needs to include timepoints before and after t=0 and one should have reached
a decent fit of most features in the spectrum. We perform an Nelder-Mead optimisation
of the parameter followed by a Nelder-Mead optimization of the chirp parameter
as one iteration. After each consecutive optimization it is checked if the total error
improved. If not the fit is ended, if yes the maximum number of iterations
‘fit_chirp_iterations’ is performed. Warning, this goes well in many cases,
but can lead to very strange results in others, always carefully check the results.
I recommend to make a copy of the object before runnning a chirp optimization.</p></li>
<li><p><strong>fit_chirp_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of times the global - chirp loop is repeated.
Typically this iterations run 2-5 times, (Default) is 10</p></li>
<li><p><strong>dump_paras</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) is False, If True creates two files in the working folder, one with the
currently used parameter created at the end of each optimisation step, and one with
the set of parameter that up to now gave the lowest error. Intented to store
the optimisation results if the fit needs to be interrupted
(if e.g. Ampgo simply needs to long to optimize.) useful option if things are slow
this parameter also triggers the writing of fitout to a textfile on disc</p></li>
<li><p><strong>filename</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Only used in conjunction with ‘dump_paras’. The program uses this filename to dump the
parameter to disk</p></li>
<li><p><strong>multi_project</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of TA projects</em><em>)</em><em>, </em><em>optional</em>) – This switch is triggering the simultaneous optimisation of multiple datasets.
multi_project is as (Default) None. it expects an iterable (typically list) with other
TA projects (like ta) that are then optimised with the same parameter.
This means that all projects get the same parameter object for each iteration
of the fit and return their individual error, which is summed linearly.
The “weights” option allows to give each multi_project a specific weight (number)
that is multiplied to the error. If the weight object has the same number of items
as the multi_project it is assumed that the triggering object (the embedded project)
has the weight of 1, otherwise the first weight is for the embedded project.
The option ‘unique_parameter’ takes (a list) of parameter that are not
to be shared between the projects (and that are not optimized either)
The intended use of this is to give e.g. the pump power for multiple experiments to
study non linear behaviour. Returned will be only the parameter set for the optimium
combination of all parameter. Internally, we iterate through the projects and calculate
for each project the error for each iteration. Important to note is that currently this
means that each DAS/SAS is calculated independently! For performing the same calculation
with a single DAS, the Matrixes need to be concatenated before the run and an external
function used to create a combined model. As this is very difficult to implement reliably
For general use (think e.g. different pump wavelength) this has to be done manually.</p></li>
<li><p><strong>unique_parameter</strong> (<em>None</em><em> or </em><em>str</em><em> or </em><em>list</em><em> (</em><em>of strings</em><em>)</em><em>, </em><em>optional</em>) – only used in conjunction with ‘multi_project’, it takes (a list) of parameter that
are not to be shared between the projects (and that are not optimized either)
The intended use of this is to give e.g. the pump power for multiple experiments
to study non linear behaviour. (Default) None</p></li>
<li><p><strong>weights</strong> (<em>list of floats</em><em>, </em><em>optional</em>) – only used in conjunction with ‘multi_project’. The “weights” option allows to
give each multi_project a specific weight (number) that is multiplied to the error.
If the weight object has the same number of items as the ‘multi_project’ it is assumed
that ta (the embedded project) has the weight of 1, otherwise the first weight is for the
embedded object</p></li>
<li><p><strong>ext_spectra</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – (Default) is None, if given substract this spectra from the DataMatrix using the intensity
given in “C(t)” this function will only work for external models. The name of the spectral column
must be same as the name of the column used. If not the spectrum will be ignored. The spectrum will
be interpolated to the spectral points of the model ds before the substraction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>re</strong> (<em>dict</em>) – the dictionary “re” attached to the object containing all the matrixes and parameter.
The usual keys are:
“A” Shaped measured Matrix
“AC” Shaped calculated Matrix
“AE” Difference between A and AC = linear error
“DAS” DAS or SAS, labeled after the names given in the function (the columns of c) Care must be taken that this mesured intensity is C * DAS, the product. For exponential model the concentrations are normalized
“c” The Concentrations (meaning the evolution of the concentrations over time. Care must be taken that this mesured intensity is C * DAS, the product. For exponential model the concentrations are normalized
“fit_results_rates” DataFrame with the fitted rates (and the confidence intervals if calculated)
“fit_results_times” DataFrame with the fitted decay times (and the confidence intervals if calculated)
“fit_output” The Fit object as returned from lmfit. (This is not saved with the project!)
“error” is the S2, meaning AE**2.sum().sum()
“r2”=1-“error”/((‘A’-‘A’.mean())**2).sum(), so the residuals scaled with the signal size</p></li>
<li><p><strong>par_fit</strong> (<em>lmfit parameter object</em>) – is written into the object as a lmfit parameter object with the optimized results (that can be use further)</p></li>
<li><p><strong>fitcoeff</strong> (<em>list, if chirpfit is done</em>) – The chirp parameter are updated</p></li>
<li><p><strong>ds</strong> (<em>DataFrame, if chirpfit is done</em>) – A new ds is calculated form ds_ori if ChripFit is done</p></li>
<li><p><em>The rest is mainly printed on screen.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Non optional:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;testfile.SIA&#39;</span><span class="p">)</span> <span class="c1">#load data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">mod</span><span class="o">=</span><span class="s1">&#39;exponential&#39;</span>    <span class="c1">#define model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">par</span><span class="o">=</span><span class="n">lmfit</span><span class="o">.</span><span class="n">Parameters</span><span class="p">()</span>  <span class="c1">#create empty parameter object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;k0&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#add at least one parameter to optimize</span>
</pre></div>
</div>
<p>Trigger simple fit:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Fit_Global</span><span class="p">()</span>
</pre></div>
</div>
<p>Trigger fit with Chrip Fit:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Fit_Global</span><span class="p">(</span><span class="n">fit_chirp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Trigger iterative Chirp fitting with fresh refinement of the Global kinetic parametersfor i in range(5):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">start_error</span><span class="o">=</span><span class="n">ta</span><span class="o">.</span><span class="n">re</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ta</span><span class="o">.</span><span class="n">par</span><span class="o">=</span><span class="n">ta</span><span class="o">.</span><span class="n">par_fit</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ta</span><span class="o">.</span><span class="n">Fit_Global</span><span class="p">(</span><span class="n">fit_chirp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">ta</span><span class="o">.</span><span class="n">re</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">start_error</span><span class="p">:</span><span class="k">break</span>
</pre></div>
</div>
<p>Trigger fit fit error calculations</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Fit_Global</span><span class="p">(</span><span class="n">confidence_level</span><span class="o">=</span><span class="mf">0.66</span><span class="p">)</span>
</pre></div>
</div>
<p>Trigger fit of multiple projects
#use the GUI_open function to open a list of objects (leave empty for using the GUI)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">other_projects</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">([</span><span class="s1">&#39;sample_1.hdf5&#39;</span><span class="p">,</span><span class="s1">&#39;sample_2.hdf5&#39;</span><span class="p">],</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Fit_Global</span><span class="p">(</span><span class="n">multi_project</span><span class="o">=</span><span class="n">other_projects</span><span class="p">)</span>
</pre></div>
</div>
<p>For more examples please see the complete documentation under <a class="reference internal" href="Fitting.html#fitting-parameter-optimization-and-error-estimation"><span class="std std-ref">Fitting, Parameter optimization and Error estimation</span></a>
or <a class="reference internal" href="Fitting.html#fitting-multiple-measured-files-at-once"><span class="std std-ref">Fitting multiple measured files at once</span></a></p>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Man_Chirp">
<code class="sig-name descname">Man_Chirp</code><span class="sig-paren">(</span><em class="sig-param">shown_window=[-1, 1], path=None, max_points=40, cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Man_Chirp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Man_Chirp" title="Permalink to this definition">¶</a></dt>
<dd><p>Triggering of Manuel Fix_Chirp. usually used when Cor_Chirp has run aleady.
Alternatively delete the chirp file.</p>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Plot_RAW">
<code class="sig-name descname">Plot_RAW</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plotting</span><span class="o">=</span><span class="default_value">range(0, 4)</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale_type</span><span class="o">=</span><span class="default_value">'symlog'</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'result_figures'</span></em>, <em class="sig-param"><span class="n">savetype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">print_click_position</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot_second_as_energy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">ds</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Plot_RAW"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Plot_RAW" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper function that triggers the plotting of various RAW (non fitted) plots.
The shaping parameter are taken from the object and should be defined before.
The parameter in this plot call are to control the general look and features of the plot.
Which plots are printed is defined byt the first command (plotting)
The plots are generated on the fly using self.ds and all the shaping parameter
In all plots the RAW data is plotted as dots and interpolated with lines
(using Savitzky-Golay window=5, order=3 interpolation). As defined by the internal parameters
at selected time-points and the kinetics for selected wavelength are shaped by the
object parameter. The SVD is performed using the same shaping parameter and is commonly
used as an orientation for the number of components in the data.
Everything is handed over to ‘plot_raw’ function that can be used for extended RAW plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotting</strong> (<em>int</em><em> or </em><em>iterable</em><em> (</em><em>of integers</em><em>)</em><em>, </em><em>optional</em>) – <p>This parameter determines which figures are plotted
the figures can be called separately with plotting = 1
or with a list of plots (Default) e.g. plotting=range(4) calls plots 0,1,2,3.
The plots have the following numbers:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li><p>Matrix</p></li>
<li><p>Kinetics</p></li>
<li><p>Spectra</p></li>
<li><p>SVD</p></li>
</ol>
</div></blockquote>
<p>The plotting takes all parameter from the “ta” object.</p>
</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em>) – title to be used on top of each plot
The (Default) None triggers  self.filename to be used. Setting a specific title as string will.
be used in all plots. To remove the title all together set an empty string with this command title=”” .</p></li>
<li><p><strong>Scale_type</strong> (<em>None</em><em> or </em><em>str</em>) – is a general setting that can influences what time axis will be used for the plots.
“symlog” (linear around zero and logarithmic otherwise) “lin” and “log” are valid options.</p></li>
<li><p><strong>times</strong> (<em>int</em>) – are the number of components to be used in the SVD (Default) is 6.</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – offers to replace the base-name used for all plots (to e.g.~specify what sample was used).
if (Default) None is used, the self.filename is used as a base name. The filename plays only a
role during saving, as does the path and savetype.</p></li>
<li><p><strong>path</strong> (<em>None</em><em> or </em><em>str</em><em> or </em><em>path object</em><em>, </em><em>optional</em>) – This defines where the files are saved if the safe_figures_to_folder parameter is True,
quite useful if a lot of data sets are to be printed fast.
If a path is given, this is used. If a string like the (Default) “result_figures” is given,
then a subfolder of this name will be used (an generated if necessary)
relative to self.path. Use and empty string to use the self.path
If set to None, the location of the plot_func will be used and
a subfolder with title “result_figures” be generated here.</p></li>
<li><p><strong>savetype</strong> (<em>str</em><em> or </em><em>iterable</em><em> (</em><em>of str</em><em>)</em><em>, </em><em>optional</em>) – matplotlib allows the saving of figures in various formats. (Default) “png”,
typical and recommendable options are “svg” and “pdf”.</p></li>
<li><p><strong>print_click_position</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True then the click position is printed for the spectral plots</p></li>
<li><p><strong>ds</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – if None (Default), the program first tests self.ds and if this is not there then self.ds_ori.
This option was introduced to allow plotting of other matrixes with the same parameter</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Typically one would call this function empty for an overview. We name the object “ta” so with</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;testfile.SIA&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This would trigger the plotting of the 4 mayor plots for an overview.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Plot_RAW</span><span class="p">()</span>
</pre></div>
</div>
<p>This would plot only the kinetics.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Plot_RAW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Plot_RAW</span><span class="p">(</span><span class="n">plotting</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Plot_fit_output">
<code class="sig-name descname">Plot_fit_output</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plotting</span><span class="o">=</span><span class="default_value">range(0, 6)</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'result_figures'</span></em>, <em class="sig-param"><span class="n">savetype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">evaluation_style</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale_type</span><span class="o">=</span><span class="default_value">'symlog'</span></em>, <em class="sig-param"><span class="n">patches</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">print_click_position</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot_second_as_energy</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Plot_fit_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Plot_fit_output" title="Permalink to this definition">¶</a></dt>
<dd><p>plots all the fit output figures. The figures can be called separately
or with a list of plots. e.g. range(6) call plots 0-5 Manual plotting of certain type:</p>
<p>This is a wrapper function that triggers the plotting of all the fitted plots.
The parameter in this plot call are to control the general look and features of the plot.
Which plots are printed is defined by the first command (plotting)
The plots are generated from the fitted Matrixes and as such only will work after a fit was actually
completed (and the “re” dictionary attached to the object.)
In all plots the RAW data is plotted as dots and the fit with lines</p>
<p>Contents of the plots</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li><p>DAC contains the assigned spectra for each component of the fit. For
a modelling with independent exponential decays this corresponds to
the “Decay Associated Spectra” (DAS). For all other models this
contains the “Species Associated Spectra” (SAS). According to the
model the separate spectra are labeled by time (process) or name, if
a name is associated in the fitting model. The spectra are shown in
the extracted strength in the right pane and normalized in the left.
Extracted strength means that the measured spectral strength is the
intensity (concentration matrix) times this spectral strength. As the
concentration maxima for all DAS are 1 this corresponds to the
spectral strength for the DAS. (please see the documentation for the
fitting algorithm for further details).</p></li>
<li><p>summed intensity. All wavelength of the spectral axis are summed for
data and fit. The data is plotted in a number of ways vs linear and
logarithmic axis. This plot is not ment for publication but very
useful to evaluate the quality of a fit.</p></li>
<li><p>plot kinetics for selected wavelength (see corresponding RAW plot).</p></li>
<li><p>plot spectra at selected times (see corresponding RAW plot).</p></li>
<li><p>plots matrix (measured, modelled and error Matrix). The parameter are
the same as used for the corresponding RAW plot with the addition of
“error_matrix_amplification” which is a scaling factor multiplied
onto the error matrix. I recommend to play with different “cmap”,
“log_scale” and “intensity_scale” to create a pleasing plot.</p></li>
<li><p>concentrations. In the progress of the modelling/fitting a matrix is
generated that contains the relative concentrations of the species
modelled. This plot is showing the temporal development of these
species. Further details on how this matrix is generated can be found
in the documentation of the fitting function. The modeled spectra are
the convolution of these vectors (giving the time-development) and
the DAS/SAS (giving the spectral development).</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotting</strong> (<em>int</em><em> or </em><em>iterable</em><em> (</em><em>of integers</em><em>)</em><em>, </em><em>optional</em>) – <p>This parameter determines which figures are plotted
the figures can be called separately with plotting = 1
or with a list of plots (Default) e.g. plotting=range(6) calls plots 0,1,2,3,4,5
The plots have the following numbers:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li><p>DAS or SAS</p></li>
<li><p>summed intensity</p></li>
<li><p>Kinetics</p></li>
<li><p>Spectra</p></li>
<li><p>Matrixes</p></li>
<li><p>Concentrations (the c-object)</p></li>
</ol>
</div></blockquote>
<p>The plotting takes all parameter from the “ta” object unless otherwise specified</p>
</p></li>
<li><p><strong>path</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>path object</em><em>, </em><em>optional</em>) – This defines where the files are saved if the safe_figures_to_folder parameter is True,
quite useful if a lot of data sets are to be printed fast.
If a path is given, this is used. If a string like the (Default) “result_figures” is given,
then a subfolder of this name will be used (an generated if necessary)
relative to self.path. Use and empty string to use the self.path
If set to None, the location of the plot_func will be used and
a subfolder with title “result_figures” be generated here</p></li>
<li><p><strong>savetype</strong> (<em>str</em><em> or </em><em>iterable</em><em> (</em><em>of str</em><em>)</em><em>, </em><em>optional</em>) – matplotlib allows the saving of figures in various formats. (Default) “png”,
typical and recommendable options are “svg” and “pdf”.</p></li>
<li><p><strong>evaluation_style</strong> (<em>bool</em><em>, </em><em>optional</em>) – True (Default = False) adds a lot of extra information in the plot</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – “title=None” is in general the filename that was loaded. Setting a
specific title will be used in all plots. To remove the title all
together set an empty string with title=””</p></li>
<li><p><strong>scale_type</strong> (<em>str</em><em>, </em><em>optional</em>) – refers to the time-axis and takes, “symlog” (Default)(linear around zero and logarithmic otherwise)
and “lin” for linear and  “log” for logarithmic, switching all the time axis to this type</p></li>
<li><p><strong>patches</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False (Default) the names “measured” “fitted” “difference” will be placed above the images.
If True, then they will be included into the image (denser)</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – offers to replace the base-name used for all plots (to e.g.specify what sample was used).
if (Default) None is used, the self.filename is used as a base name. The filename plays only a
role during saving, as does the path and savetype</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
<li><p><strong>print_click_position</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True then the click position is printed for the spectral plots</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Typically one would call this function empty for an overview:
After the minimum fit</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;testfile.SIA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">par</span><span class="o">=</span><span class="n">lmfit</span><span class="o">.</span><span class="n">Parameters</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;k0&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Fit_Global</span><span class="p">()</span>
</pre></div>
</div>
<p>One usually plots the an overview</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Plot_fit_output</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Plot_fit_output</span><span class="p">(</span><span class="n">plotting</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c1">#is the same as before</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Plot_fit_output</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#would plot only the kinetics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Plot_fit_output</span><span class="p">(</span><span class="n">plotting</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">#would plot only the kinetics</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Save_Plots">
<code class="sig-name descname">Save_Plots</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'result_figures'</span></em>, <em class="sig-param"><span class="n">savetype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale_type</span><span class="o">=</span><span class="default_value">'symlog'</span></em>, <em class="sig-param"><span class="n">patches</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Save_Plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Save_Plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that sets save_plots_to_folder temporarily to true and replots everything</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>path</em><em>, </em><em>optional</em>) – (Default) None, if left on None, then a folder “result_figures” is created in the folder
of the data (self.path)</p></li>
<li><p><strong>savetype</strong> (<em>str</em><em> or </em><em>iterable</em><em> (</em><em>of str</em><em>)</em><em>, </em><em>optional</em>) – matplotlib allows the saving of figures in various formats. (Default) “png”,
typical and recommendable options are “svg” and “pdf”.</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – (Default) None, Use this title on all plots. if None, use self.filename</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – (Default) None, Base name for all plots. If None, then self.filename will be used</p></li>
<li><p><strong>scale_type</strong> (<em>str</em><em>, </em><em>optional</em>) – “symlog” (Default), “linear”, “log” time axis</p></li>
<li><p><strong>patches</strong> (<em>bool</em><em>, </em><em>optional</em>) – For true use white patches to label things in the 2d matrixes, to safe
space for publication</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Save_Plots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Save_Plots</span><span class="p">(</span><span class="n">patches</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Save_Powerpoint">
<code class="sig-name descname">Save_Powerpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_RAW</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">save_Fit</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'result_figures'</span></em>, <em class="sig-param"><span class="n">scale_type</span><span class="o">=</span><span class="default_value">'symlog'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">patches</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">savetype</span><span class="o">=</span><span class="default_value">'pptx'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Save_Powerpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Save_Powerpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates two power point slides. On the first it summarizes the RAW plots and on
the second (if existent) it summarizes the fitted results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_RAW</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) True then the first slide with the RAW data is created</p></li>
<li><p><strong>save_Fit</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) True then the second slide with the Fitted data is created</p></li>
<li><p><strong>path</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>path</em><em>, </em><em>optional</em>) – (Default) None, if left on None, then a folder “result_figures” is created in the folder
of the data (self.path)</p></li>
<li><p><strong>savetype</strong> (<em>str</em><em> or </em><em>iterable</em><em> (</em><em>of str</em><em>)</em><em>, </em><em>optional</em>) – triggers the additional creation of a composite file in this format.
matplotlib allows the saving of figures in various formats. (Default) “png”,
typical and recommendable options are “svg” and “pdf”.</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – (Default) None, Use this title on all plots. if None, use self.filename</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – (Default) None, Base name for all plots. If None, then self.filename will be used</p></li>
<li><p><strong>scale_type</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘symlog’ (Default), ‘linear’, ‘log’ time axis</p></li>
<li><p><strong>patches</strong> (<em>bool</em><em>, </em><em>optional</em>) – For true use white patches to label things in the 2d matrixes, to safe
space for publication</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Save_Powerpoint</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Save_Powerpoint</span><span class="p">(</span><span class="n">patches</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Save_data">
<code class="sig-name descname">Save_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_RAW</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">save_Fit</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">save_slices</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">save_binned</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fit_results</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'Data_export'</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'\t'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Save_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Save_data" title="Permalink to this definition">¶</a></dt>
<dd><p>handy function to save the data on disk as dat files.
The RAW labeled files contain the chirp corrected values (self.ds)</p>
<p>the save_slices switch turns on the dump of the separate sliced figures (time and spectral)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_binned</strong> (<em>bool</em><em>, </em><em>optional</em>) – is also the re-binned matrix to be saved.</p></li>
<li><p><strong>save_slices</strong> (<em>bool</em><em>, </em><em>optional</em>) – save the kinetics and spectra from the fitted data (with the fits)</p></li>
<li><p><strong>sep</strong> (<em>str</em><em>, </em><em>optional</em>) – what symbol is used to separate different number. (typical either ‘tab’ or comma</p></li>
<li><p><strong>save_RAW</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) True then the first slide with the RAW data is created</p></li>
<li><p><strong>save_Fit</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) True then the second slide with the Fitted data is created</p></li>
<li><p><strong>path</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>path</em><em>, </em><em>optional</em>) – (Default) None, if left on None, then a folder “result_figures” is created in the folder
of the data (self.path)</p></li>
<li><p><strong>save_fit_results</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True (Default)  a neatly formated file with the fit results is created and stored with the data</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – (Default) None, Base name for all plots. If None, then self.filename will be used</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Save_Data</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.Save_project">
<code class="sig-name descname">Save_project</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.Save_project"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.Save_project" title="Permalink to this definition">¶</a></dt>
<dd><p>function to dump all the parameter of an analysis into an hdf5 file.
This file contains the ds_ori and all the parameter, including fitting parameter
and results.
One limitation is the fitting model. If the model is build in, so the model is
‘exponential’ or ‘parallel’ then the safing works. If an external model is used then the
dostring of the external function is stored, but not the function itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>path</em><em>, </em><em>optional</em>) – (Default) None, if left on None, then a folder “Data” is created in the folder
of the project (self.path)</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – (Default) None, Base name for all plots. If None, then self.filename will be used</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">Save_project</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'\t'</span></em>, <em class="sig-param"><span class="n">decimal</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">index_is_energy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transpose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sort_indexes</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">divide_times_by</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">shift_times_by</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_wave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#TA.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.TA.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that opens and imports data into an TA object
it is designed to open combined files that contain both the wavelength and the time. (e.g. SIA files as recorded by Pascher instruments software) or hdf5 projects saved by this software
There are however a lot of additional options to open other ascii type files and adapt their format internally
Attention times with Nan will be completely removed during the import</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – expects a filename in string form for opening a single file. alternatively ‘gui’ can be set as
filename, then a TKinter gui is opened for select.</p></li>
<li><p><strong>path</strong> (<em>str</em><em> or </em><em>path object</em><em> (</em><em>optional</em><em>)</em>) – if path is a string without the operation system dependent separator, it is treated as a relative path,
e.g. data will look from the working directory in the sub director data. Otherwise this has to be a
full path in either strong or path object form.</p></li>
<li><p><strong>sep</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – is the separator between different numbers, typical are tap (Backslash t) (Default) ,one or
multiple white spaces ‘backslash s+’ or comma ‘,’.</p></li>
<li><p><strong>decimal</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – sets the ascii symbol that is used for the decimal sign. In most countries this is ‘.’(Default)
but it can be ‘,’ in countries like Sweden or Germany</p></li>
<li><p><strong>index_is_energy</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – switches if the wavelength is given in nm (Default) or in eV (if True), currently everything
is handled as wavelength in nm internally</p></li>
<li><p><strong>data_type</strong> (<em>str</em><em>, </em><em>None</em>) – data_type is the string that represents the intensity measurements. Usually this contains if absolute
of differential data. This is used for the color intensity in the 2d plots and the y-axis for the 1d plots</p></li>
<li><p><strong>units</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – this is used to identify the units on the energy axis and to label the slices, recognized is ‘nm’, ‘eV’ and ‘keV’
but if another unit like ‘cm^-1’ is used it will state energy in ‘cm^-1’. Pleas observe that if you use the index_is_energy
switch the program tries to convert this energy into wavelength.</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – if this switch is False (Default) the wavelength are the columns and the rows the times.</p></li>
<li><p><strong>sort_indexes</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – For False (Default) I assume that the times and energies are already in a rising order.
with this switch, both are sorted again.</p></li>
<li><p><strong>divide_times_by</strong> (<em>bool</em><em> or </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – here a number can be given that scales the time by an arbitary factor. This is actually dividing
the times by this value. Alternatively there is the variable self.baseunit. The latter only affects
what is written on the axis, while this value is actually used to scale the times. False (Default)
ignores this</p></li>
<li><p><strong>shift_times_by</strong> (<em>None</em><em>, </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – This a value by which the time axis is shifted during import. This is a useful option of e.g.
the recording software does not compensate for t0 and the data is always shifted.
None (Default) ignores this setting</p></li>
<li><p><strong>data_type</strong> – this is the datatype and effectively the unit put on the intensity axis
(Default)’differential Absorption in $mathregular{Delta OD}$</p></li>
<li><p><strong>external_time</strong> (<em>None</em><em> or </em><em>str</em><em> (</em><em>optional</em><em>)</em>) – Here a filename extension (string) can be given that contains the time vector.
The file is assumed to be at the same path as the data and to contain a single
type of separated data without header. It also assumes that this is the ending
for the file. The filename itself is taken from the filename.
e.g. if samp1.txt is the filename and external_time=’.tid’ the program searches
samp1.tid for the times. The transpose setting is applied and sets where the times are
to be inserted (row or column indexes)</p></li>
<li><p><strong>external_wave</strong> (<em>None</em><em> or </em><em>str</em><em> (</em><em>optional</em><em>)</em>) – Here a filename extension (string) can be given that contains the wavelength vector.
The file is assumed to be at the same path as the data and to contain a single type
of separated data without header. This is the ending for the file. The filename itself
is taken from the filename. e.g. if samp1.txt is the filename and external_wave=’.wav’
then the program searches samp1.wav for the wavelength. The transpose setting is applied
and sets where the wavelength are to be inserted (columns or row indexes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A TA object with all parameter initialized</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Typical useage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plot_func</span> <span class="k">as</span> <span class="nn">pf</span> <span class="c1">#import the module and give it a shorter name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;gui&#39;</span><span class="p">)</span> <span class="c1">#use a GUI to open</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;sample_1.SIA&#39;</span><span class="p">)</span> <span class="c1">#use a filename in the same folder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">TA</span><span class="p">(</span><span class="s1">&#39;sample_1.hdf5&#39;</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span> <span class="c1">#use a filename in the folder &#39;Data&#39;</span>
</pre></div>
</div>
<p>Opening a list of files with external time vector (of the same name) so it looks for a data
file “fite1.txt” and a file with the time information “file1.tid”</p>
<p>&gt;&gt;&gt;ta=pf.TA(‘file1.txt’, external_time = ‘tid’)</p>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.__make_standard_parameter">
<code class="sig-name descname">__make_standard_parameter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#plot_func.TA.__make_standard_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>function that sets the standard parameter. The function takes no input, but we use this docstring to explain the parameter.</p>
<blockquote>
<div><dl>
<dt>log_scale<span class="classifier">bool, optional</span></dt><dd><p>If False (Default), The 2D plots (Matrix) is plotted with a pseudo logarithmic intensity scale.
This usually does not give good results unless the intensity scale is symmetric</p>
</dd>
<dt>self.cmap<span class="classifier">matplotlib.cm</span></dt><dd><p>(Default)  standard_map - global parameter
cmap is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p>
</dd>
<dt>lintresh<span class="classifier">float</span></dt><dd><p>The pseudo logratihmic range “symlog” is used for most time axis. Symlog plots a range around
time zero linear and beyond this linear treshold ‘lintresh’ on a logarithmic scale. (Default) 0.3</p>
</dd>
<dt>self.log_fit  :</dt><dd><p>(Default)  False</p>
<p>Transfer all the time-fitting parameters into log-space before the fit</p>
</dd>
<dt>self.ignore_time_region<span class="classifier">None or list (of two floats or of lists)</span></dt><dd><p>(Default)  None
cut set a time range with a low and high limit from the fits. (Default) None nothing happens
The region will be removed during the fitting process (and will be missing in the fit-result
plots)</p>
<p>Usage single region: [lower region limit,upper region limit]</p>
<p>use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p>
</dd>
<dt>self.error_matrix_amplification  :</dt><dd><p>(Default)  10</p>
</dd>
<dt>self.rel_wave<span class="classifier">float or list (of floats)</span></dt><dd><p>(Default)  np.arange(300,1000,100)</p>
<p>‘rel_wave’ and ‘width’ (in the object called ‘wavelength_bin’ work together for the creation
of kinetic plots. When plotting kinetic spectra one line will be plotted for each entrance
in the list/vector rel_wave. During object generation the vector np.arange(300,1000,100)
is set as standard. Another typical using style would be to define a list of interesting
wavelength at which a kinetic development is to be plotted. At each selected wavelength
the data between wavelength+ta.wavelength_bin and wavelength-ta.wavelength_bin is averaged
for each timepoint returned</p>
</dd>
<dt>self.rel_time<span class="classifier">float or list/vector (of floats)</span></dt><dd><p>(Default)  [0.2,0.3,0.5,1,3,10,30,100,300,1000,3000,9000]</p>
<p>For each entry in rel_time a spectrum is plotted. If time_width_percent=0 (Default) the
nearest measured timepoint is chosen. For other values see ‘time_width_percent’</p>
</dd>
<dt>self.time_width_percent<span class="classifier">float</span></dt><dd><p>(Default)  0 “rel_time” and “time_width_percent” work together for
creating spectral plots at specific timepoints. For each entry
in rel_time a spectrum is plotted. If however e.g. time_width_percent=10
the region between the timepoint closest to the  1.1 x timepoint
and 0.9 x timepoint is averaged and shown (and the legend adjusted accordingly).
This is particularly useful for the densly
sampled region close to t=0. Typically for a logarithmic recorded kinetics, the
timepoints at later times will be further appart than 10 percent of the value,
but this allows to elegantly combine values around time=0 for better statistics.
This averaging is only applied for the plotting function and not for the fits.</p>
</dd>
<dt>self.baseunit<span class="classifier">str</span></dt><dd><p>(Default)  ‘ps’</p>
<p>baseunit is a neat way to change the unit on the time axis of the plots. (Default) ‘ps’, but they
can be frames or something similarly. This is changing only the label of the axis.
During the import there is the option to divide the numbers by a factor.
I have also used frames or fs as units. Important is that all time units will be labeled with
this unit.</p>
</dd>
<dt>self.mod  :</dt><dd><p>(Default)  ‘exponential’</p>
<p>This is the default fitting function, in general this is discussed in the fitting section</p>
</dd>
<dt>self.scattercut<span class="classifier">None or iterable (of floats or other iterable, always pairs!)</span></dt><dd><p>(Default)  None</p>
<p>intented to “cut” one or multiple scatter regions. (if (Default) None nothing
happens) If it is set the spectral region between the limits is set to zero.
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p>
</dd>
<dt>self.bordercut<span class="classifier">None or iterable (with two floats)</span></dt><dd><p>(Default)  None</p>
<p>cut spectra at the low and high wavelength limit. (Default) None
uses the limits of measurement</p>
</dd>
<dt>self.time_bin<span class="classifier">None or int</span></dt><dd><p>(Default)  None
is dividing the points on the time-axis in even bins and averages the found values in between.
This is a hard approach that also affects the fits. I do recommend to use this carefully,
it is most useful for modulated data. A better choice for transient absorption that only
affects the kinetics is ‘time_width_percent’</p>
</dd>
<dt>self.timelimits<span class="classifier">None or list (of 2 floats)</span></dt><dd><p>(Default)  None</p>
<p>cut times at the low and high time limit. (Default) None uses the limits of measurement
Important: If either the background or the chirp is to be fit this must include the
time before zero! Useful: It is useful to work on different regions, starting with
the longest (then use the ta.Backgound function prior to fit) and expand from there</p>
</dd>
<dt>data_type<span class="classifier">str</span></dt><dd><p>this is the datatype and effectively the unit put on the intensity axis
(Default)’differential Absorption in $mathregular{Delta OD}$</p>
</dd>
<dt>self.wave_nm_bin<span class="classifier">None or float</span></dt><dd><p>(Default)  None</p>
<p>rebins the original data into even intervals. If set to None the original data will be used.
If set to a width (e.g. 2nm), the wavelength axis will be divided into steps of this size
and the mean of all measurements in the interval is taken. The re-binning stops as soon as
the measured stepsize is wider than given here, then the original bins are used.
This function is particularly useful for spectrometer with non-linear dispersion,
like a prism in the infrared.</p>
</dd>
<dt>self.wavelength_bin<span class="classifier">float, optional</span></dt><dd><p>(Default)  10nm the width used in kinetics, see below</p>
</dd>
<dt>self.intensity_range<span class="classifier">None, float or list [of two floats]</span></dt><dd><p>(Default)  None - intensity_range is a general switch that governs what intensity range the plots show.
For the 1d plots this is the y-axis for the 2d-plots this is the colour scale.
This parameter recognizes three settings. If set to “None” (Default) this uses the minimum and
maximum of the data. A single value like in the example below and the intended use is the symmetric
scale while a list with two entries an assymmetric scale e.g.
intensity_range=3e-3 is converted into intensity_range=[-3e-3,3e-3]</p>
</dd>
<dt>self.ds_ori.columns.name  :</dt><dd><p>(Default)  ‘Wavelength in nm’</p>
<p>This is the general energy axis. here we define it with the unit. Change this to energy for use in e.g x-ray science</p>
</dd>
<dt>self.ds_ori.index.name :</dt><dd><p>Standard ‘Time in %s’ % self.baseunit</p>
</dd>
<dt>self.data_type: str (optional)</dt><dd><p>self.data_type=’diff. Absorption</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>in $mathregular{Delta OD}$’</dt><dd><dl class="simple">
<dt>self.fitcoeff<span class="classifier">list (5 floats)</span></dt><dd><p>chirp correction polynom</p>
</dd>
<dt>self.chirp_file<span class="classifier">str</span></dt><dd><p>if there is a file withthe right name write it here, otherwise None</p>
</dd>
<dt>self.figure_path<span class="classifier">str</span></dt><dd><p>Path for saving figures, if set</p>
</dd>
<dt>self.save_figures_to_folder<span class="classifier">bool</span></dt><dd><p>if True all figures are automatically saved when any plotfunction is called</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">bordercut</span><span class="o">=</span><span class="p">[</span><span class="mi">350</span><span class="p">,</span><span class="mi">1200</span><span class="p">]</span>  <span class="c1">#remove all data outside this limit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">scattercut</span><span class="o">=</span><span class="p">[</span><span class="mi">522</span><span class="p">,</span><span class="mi">605</span><span class="p">]</span>  <span class="c1">#set data inside this limit to zero</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">timelimits</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">5000</span><span class="p">]</span>  <span class="c1">#remove all data outside this limit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">wave_nm_bin</span><span class="o">=</span><span class="mi">5</span>  <span class="c1">#rebin the data to this width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">intensity_range</span><span class="o">=</span><span class="mf">3e-3</span>  <span class="c1">#equivalent to [-3e-3,3e-3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">intensity_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1e-3</span><span class="p">,</span><span class="mf">3e-3</span><span class="p">]</span>  <span class="c1">#intensity that is plotted in 2d plot and y-axis in 1d plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">prism</span>  <span class="c1">#choose different colour map</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">ignore_time_region</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span> <span class="c1">#ignore -0.1ps to 0.1ps</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="plot_func.TA.__read_ascii_data">
<code class="sig-name descname">__read_ascii_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'\t'</span></em>, <em class="sig-param"><span class="n">decimal</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">index_is_energy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transpose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sort_indexes</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">divide_times_by</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">shift_times_by</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_wave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">correct_ascii_errors</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#plot_func.TA.__read_ascii_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Fancy function that handles the import of pure ascii files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sep</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – is the separator between different numbers, typical are tap (Backslash t) (Default) ,one or
multiple white spaces ‘backslash s+’ or comma ‘,’.</p></li>
<li><p><strong>decimal</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – sets the ascii symbol that is used for the decimal sign. In most countries this is ‘.’(Default)
but it can be ‘,’ in countries like Sweden or Germany</p></li>
<li><p><strong>index_is_energy</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – switches if the wavelength is given in nm (Default) or in eV (if True), currently everything
is handled as wavelength in nm internally</p></li>
<li><p><strong>data_type</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – data_type is the string that represents the intensity measurements. Usually this contains if absolute
of differential data. This is used for the color intensity in the 2d plots and the y-axis for the 1d plots</p></li>
<li><p><strong>units</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – this is used to identify the units on the energy axis and to label the slices, recognized is ‘nm’, ‘eV’ and ‘keV’
but if another unit like ‘cm^-1’ is used it will state energy in ‘cm^-1’. Pleas observe that if you use the index_is_energy
switch the program tries to convert this energy into wavelength.</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – if this switch is False (Default) the wavelength are the columns and the rows the times.</p></li>
<li><p><strong>sort_indexes</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – For False (Default) I assume that the times and energies are already in a rising order.
with this switch, both are sorted again.</p></li>
<li><p><strong>divide_times_by</strong> (<em>bool</em><em> or </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – here a number can be given that scales the time by an arbitary factor. This is actually dividing
the times by this value. Alternatively there is the variable self.baseunit. The latter only affects
what is written on the axis, while this value is actually used to scale the times. False (Default)
ignores this</p></li>
<li><p><strong>shift_times_by</strong> (<em>None</em><em>, </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – This a value by which the time axis is shifted during import. This is a useful option of e.g.
the recording software does not compensate for t0 and the data is always shifted.
None (Default) ignores this setting</p></li>
<li><p><strong>external_time</strong> (<em>None</em><em> or </em><em>str</em><em> (</em><em>optional</em><em>)</em>) – Here a filename extension (string) can be given that contains the time vector.
The file is assumed to be at the same path as the data and to contain a single
type of separated data without header. It also assumes that this is the ending
for the file. The filename itself is taken from the filename.
e.g. if samp1.txt is the filename and external_time=’.tid’ the program searches
samp1.tid for the times. The transpose setting is applied and sets where the times are
to be inserted (row or column indexes)</p></li>
<li><p><strong>external_wave</strong> (<em>None</em><em> or </em><em>str</em><em> (</em><em>optional</em><em>)</em>) – Here a filename extension (string) can be given that contains the wavelength vector.
The file is assumed to be at the same path as the data and to contain a single type
of separated data without header. This is the ending for the file. The filename itself
is taken from the filename. e.g. if samp1.txt is the filename and external_wave=’.wav’
then the program searches samp1.wav for the wavelength. The transpose setting is applied
and sets where the wavelength are to be inserted (columns or row indexes)</p></li>
<li><p><strong>correct_ascii_errors</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – If True (Default) then the code tries to catch some stuff like double minus signs and double dots</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-plot_func"></span><dl class="py function">
<dt id="plot_func.Frame_golay">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">Frame_golay</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">transpose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#Frame_golay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.Frame_golay" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method that returns the Golay smoothed data for each column (DataFrame) or the series</p>
</dd></dl>

<dl class="py function">
<dt id="plot_func.GUI_open">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">GUI_open</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">project_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename_part</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fileending</span><span class="o">=</span><span class="default_value">'hdf5'</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'\t'</span></em>, <em class="sig-param"><span class="n">decimal</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">index_is_energy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transpose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sort_indexes</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">divide_times_by</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">shift_times_by</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_wave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#GUI_open"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.GUI_open" title="Permalink to this definition">¶</a></dt>
<dd><p>This Function
1. opens a gui and allows the selection of multiple saved projects, which are returned as a list
2. if given a list of project names opens them
3. if given the word ‘all’, opens all files in a given folder
The general behavior is selected by the first parameter (project_list)</p>
<p>it is designed to open combined files that contain both the wavelength and the time. (e.g. SIA files as recorded by Pascher instruments software) or hdf5 projects saved by this software
There are however a lot of additional options to open other ascii type files and adapt their format internally
Important, as default the parameter “fileending” selects hdf5 files only, which are used as project files (see <a class="reference internal" href="#plot_func.TA.Save_project" title="plot_func.TA.Save_project"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_func.TA.Save_project()</span></code></a>)
for opening of other files the fileending parameter needs to be changed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>project_list</strong> (<em>list</em><em> (</em><em>of str</em><em>) or </em><em>'all'</em><em>, </em><em>optional</em>) – Give a list of filenames that will be opened and returned as a list of objects
if the project list is ‘all’ then all files in the folder specified in path. The parameter “filename_part”
and “fileending” can be used to specify this selection</p></li>
<li><p><strong>path</strong> (<em>str</em><em> or </em><em>path object</em><em> (</em><em>optional</em><em>)</em>) – if path is a string without the operation system dependent separator, it is treated as a relative path,
e.g. data will look from the working directory in the sub director data. Otherwise this has to be a
full path in either strong or path object form.</p></li>
<li><p><strong>filename_part</strong> (<em>str</em><em>, </em><em>optional</em>) – This parameter is only used for the option ‘all’, the (Default) None means do nothing. if a string is given then only
files that start with this string will be read.</p></li>
<li><p><strong>fileending</strong> (<em>str</em><em>, </em><em>optional</em>) – this string is used to select the filetype that is suppose to open. For the GUI, only these files will be shown,
with the option ‘all’ this selects the files that will be read in the folder, ‘hdf5’ (Default)</p></li>
<li><p><strong>sep</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – is the separator between different numbers, typical are tap ‘   ‘ (Default) ,one or
multiple white spaces ‘s+’ or comma ‘,’.</p></li>
<li><p><strong>decimal</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – sets the ascii symbol that is used for the decimal sign. In most countries this is ‘.’(Default)
but it can be ‘,’ in countries like Sweden or Germany</p></li>
<li><p><strong>index_is_energy</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – switches if the wavelength is given in nm (Default) or in eV (if True), currently everything
is handled as wavelength in nm internally</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – if this switch is False (Default) the wavelength are the columns and the rows the times.</p></li>
<li><p><strong>data_type</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – data_type is the string that represents the intensity measurements. Usually this contains if absolute
of differential data. This is used for the color intensity in the 2d plots and the y-axis for the 1d plots</p></li>
<li><p><strong>units</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – this is used to identify the units on the energy axis and to label the slices, recognized is ‘nm’, ‘eV’ and ‘keV’
but if another unit like ‘cm^-1’ is used it will state energy in ‘cm^-1’. Pleas observe that if you use the index_is_energy
switch the program tries to convert this energy into wavelength.</p></li>
<li><p><strong>sort_indexes</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – For False (Default) I assume that the times and energies are already in a rising order.
with this switch, both are sorted again.</p></li>
<li><p><strong>divide_times_by</strong> (<em>bool</em><em> or </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – here a number can be given that scales the time by an arbitary factor. This is actually dividing
the times by this value. Alternatively there is the variable self.baseunit. The latter only affects
what is written on the axis, while this value is actually used to scale the times. False (Default)
ignores this</p></li>
<li><p><strong>shift_times_by</strong> (<em>None</em><em>, </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – This a value by which the time axis is shifted during import. This is a useful option of e.g.
the recording software does not compensate for t0 and the data is always shifted.
None (Default) ignores this setting</p></li>
<li><p><strong>external_time</strong> (<em>None</em><em> or </em><em>str</em><em> (</em><em>optional</em><em>)</em>) – Here a filename extension (string) can be given that contains the time vector.
The file is assumed to be at the same path as the data and to contain a single
type of separated data without header. It also assumes that this is the ending
for the file. The filename itself is taken from the filename.
e.g. if samp1.txt is the filename and external_time=’.tid’ the program searches
samp1.tid for the times. The transpose setting is applied and sets where the times are
to be inserted (row or column indexes)</p></li>
<li><p><strong>external_wave</strong> (<em>None</em><em> or </em><em>str</em><em> (</em><em>optional</em><em>)</em>) – Here a filename extension (string) can be given that contains the wavelength vector.
The file is assumed to be at the same path as the data and to contain a single type
of separated data without header. This is the ending for the file. The filename itself
is taken from the filename. e.g. if samp1.txt is the filename and external_wave=’.wav’
then the program searches samp1.wav for the wavelength. The transpose setting is applied
and sets where the wavelength are to be inserted (columns or row indexes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List of opened TA objects</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plot_func</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">project_list</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">()</span> <span class="c1">#start the GUI to open project Files</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">project_list</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">(</span><span class="n">fileending</span><span class="o">=</span><span class="s1">&#39;SIA&#39;</span><span class="p">)</span> <span class="c1">#start the GUI to open SIA Files</span>
</pre></div>
</div>
<p>Opening a list of files using the file names</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">project_list</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">(</span><span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;file1.SIA&#39;</span><span class="p">,</span> <span class="s1">&#39;file2.SIA&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Opening all files in the folder “all_data” (relative to where the notebook is with the ending “hdf5”</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">project_list</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;all_data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Opening a list of files with external time vector (of the same name) so it looks for a data
file “file1.txt” and a file with the time information “file1.tid”</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">project_list</span><span class="o">=</span><span class="n">pf</span><span class="o">.</span><span class="n">GUI_open</span><span class="p">(</span><span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;file2.txt&#39;</span><span class="p">],</span> <span class="n">external_time</span> <span class="o">=</span> <span class="s1">&#39;tid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="plot_func.SVD">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">SVD</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scattercut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bordercut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">timelimits</span><span class="o">=</span><span class="default_value">[0.5, 150]</span></em>, <em class="sig-param"><span class="n">wave_nm_bin</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">time_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plotting</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">baseunit</span><span class="o">=</span><span class="default_value">'ps'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_time_region</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">'differential Absorption in $\\mathregular{\\Delta OD}$'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#SVD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.SVD" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculates the SVD and plots an overview.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>DataFrame</em>) – This dataframe contains the data to be plotted. It is copied and sliced into the
regions defined. The dataframe expects the time to be in Index and the wavelength/energy
to be in the columns. The spectra is plotted with a second (energy) axis</p></li>
<li><p><strong>times</strong> (<em>None</em><em> or </em><em>int</em>) – are the number of components to be used in the SVD (Default) is None (which is seen as 6)</p></li>
<li><p><strong>plotting</strong> (<em>bool</em>) – if True (Default) the functions plots the SVD, if False it returns the vectors</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em>) – title to be used on top of each plot
The (Default) None triggers  self.filename to be used. Setting a specific title as string will
be used in all plots. To remove the title all together set an empty string with this command title=””</p></li>
<li><p><strong>baseunit</strong> (<em>str</em>) – baseunit is a neat way to change the unit on the time axis of the plots. (Default) ‘ps’, but they
can be frames or something similarly. This is changing only the label of the axis.
During the import there is the option to divide the numbers by a factor.
I have also used frames or fs as units. Important is that all time units will be labeled with
this unit.</p></li>
<li><p><strong>timelimits</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of 2 floats</em><em>)</em><em>, </em><em>optional</em>) – cut times at the low and high time limit. (Default) [5e-1 , 150] uses the limits of measurement
Important: If either the background or the chirp is to be fit this must include the
time before zero! Useful: It is useful to work on different regions, starting with
the longest (then use the ta.Backgound function prior to fit) and expand from there</p></li>
<li><p><strong>scattercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>of floats</em><em> or </em><em>other iterable</em><em>, </em><em>always pairs!</em><em>)</em><em>, </em><em>optional</em>) – intented to “cut” one or multiple scatter regions. (if (Default) None nothing
happens) If it is set the spectral region between the limits is set to zero.
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>bordercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>with two floats</em><em>)</em><em>, </em><em>optional</em>) – cut spectra at the low and high wavelength limit. (Default) None
uses the limits of measurement</p></li>
<li><p><strong>wave_nm_bin</strong> (<em>None</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – rebins the original data into even intervals. If set to None the original data will be used.
If set to a width (e.g. 2nm), the wavelength axis will be divided into steps of this size
and the mean of all measurements in the interval is taken. The re-binning stops as soon as
the measured stepsize is wider than given here, then the original bins are used.
This function is particularly useful for spectrometer with non-linear dispersion,
like a prism in the infrared. (Default = 10)</p></li>
<li><p><strong>wavelength_bin</strong> (<em>float</em><em>, </em><em>optional</em>) – the width used in kinetics, see below (Default) 10nm</p></li>
<li><p><strong>ignore_time_region</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of two floats</em><em> or </em><em>of lists</em><em>)</em><em>, </em><em>optional</em>) – cut set a time range with a low and high limit from the fits. (Default) None nothing happens
The region will be removed during the fitting process (and will be missing in the fit-result
plots)
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>time_bin</strong> (<em>None</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – is dividing the points on the time-axis in even bins and averages the found values in between.
This is a hard approach that also affects the fits. I do recommend to use this carefully,
it is most useful for modulated data. A better choice for transient absorption that only
affects the kinetics is ‘time_width_percent’</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.Species_Spectra">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">Species_Spectra</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ta</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">conc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">das</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#Species_Spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.Species_Spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>useful help function that returns a dictionary that has DataFrame as entries and the names of the
components as keys</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ta</strong> (<em>plot_func.TA object</em><em>, </em><em>optional</em>) – This object should contain a successful fit. The function will cycle through the fitted species
and return the matrix that is formed from the dynamics and the species associated spectrum
If this given, then “conc” and “das” are ignored. We cycle through the columns of the concentration
and take the same column from the das Frame.</p></li>
<li><p><strong>conc</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – Is read only if ta_object is None. This should contain the concentration matrix with the species as
as columns</p></li>
<li><p><strong>das</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – This should contain the spectra of the species with one column per spectrum. The position of the columns
must match the columns in the conc (at least this is what is assumed)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>dicten=Species_Spectra(ta)</p>
</dd></dl>

<dl class="py function">
<dt id="plot_func.Summarize_scans">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">Summarize_scans</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_of_scans</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">path_to_scans</span><span class="o">=</span><span class="default_value">'Scans'</span></em>, <em class="sig-param"><span class="n">list_to_dump</span><span class="o">=</span><span class="default_value">'range'</span></em>, <em class="sig-param"><span class="n">window1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">window2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_name</span><span class="o">=</span><span class="default_value">'combined.SIA'</span></em>, <em class="sig-param"><span class="n">fileending</span><span class="o">=</span><span class="default_value">'SIA'</span></em>, <em class="sig-param"><span class="n">filename_part</span><span class="o">=</span><span class="default_value">'Scan'</span></em>, <em class="sig-param"><span class="n">return_removed_list</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'\t'</span></em>, <em class="sig-param"><span class="n">decimal</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">index_is_energy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transpose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sort_indexes</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">divide_times_by</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">shift_times_by</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">external_wave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_ds_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#Summarize_scans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.Summarize_scans" title="Permalink to this definition">¶</a></dt>
<dd><p>Average single scans. Uses single scans of the data set and plots them as average after different conditions. Usually one defines one or two windows in which the intensity is integrated. This integrated number is then displayed for each scan in the list. There are different tools to select certain scans that are excluded from the summary. These are defined in the list_to_dump. This list can take either be a list with the number, or a string with the words ‘single’ or ‘range’ (see below)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_of_scans</strong> (<em>None</em><em>, </em><em>'gui'</em><em> or </em><em>list</em>) – <p>‘gui’ (choose scans via gui)</p>
<p>None (Default) load scan files from the specified folder (path_to_scans) with the specified file-ending
(file_ending), if filename_part is a string than only files with this string in the name are taken</p>
<p>list of names (strings) loads this list of files
list of integers (that will be directly attached to the filename_part) to form the file name</p>
</p></li>
<li><p><strong>path_to_scans</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>path object</em><em>, </em><em>optional</em>) – specify relative or absolute path to the scan-files (Default:’Scans’)</p></li>
<li><p><strong>file_ending</strong> (<em>str</em><em>, </em><em>optional</em>) – specify the file extension of the single scan files. The Gui will only show this fileending
(Default: ‘.SIA’)</p></li>
<li><p><strong>filename_part</strong> (<em>str</em>) – specify a part of the string included in all scan-files (Default: ‘Scan’)</p></li>
<li><p><strong>window1</strong> (<em>None</em><em> or </em><em>list of 4 floats</em><em>, </em><em>optional</em>) – <p>window in time and wavelength over which each scan is averaged.</p>
<p>window must have the shape [start time, end time, start wavelength, end wavelength]
(Default: None)</p>
</p></li>
<li><p><strong>window2</strong> (<em>list of 4 floats</em><em>, </em><em>optional</em>) – <p>window in time and wavelength over which each scan is averaged.</p>
<p>window must have the shape [start time, end time, start wavelength, end wavelength]
(Default: None) IF not given then only one window will be displayed</p>
</p></li>
<li><p><strong>list_to_dump</strong> (<em>list</em><em>, </em><em>'single'</em><em> or </em><em>'range'</em><em>, </em><em>optional</em>) – <p>takes a list of scans to be excluded from the average, this list can be indexes (order)
in which the scans come, or a list of names. if this is given as a list the option “range”
is offered, which allows to add additional selection to the cut.</p>
<p><strong>’single’</strong> allows you (in a GUI) to click on single points in plotted window1 or two that
is to be removed, useful for spike removal and makes only sense in conjunction with at least
a defined window1, if none is defined window1 = [0.5,10,300,1200] will be set automatically.
A right click removes the last selection a middle click applies it. An empty middle click
(without selecting anything) finishes the gui</p>
<p><strong>’range’</strong> allows you (in a GUI) to click and define regions.</p>
<p>first left click is the left side of the window, second left click the ride side of the window.
Third left click the left side of the second window,… A right click removes the last set point.
a middle click finishes and applies the selection</p>
<p>An <strong>empty middle click</strong> (without selecting anything) finishes the gui</p>
<p>useful for spike removal and definition of exclusion region (e.g. where the sample died)
This makes only sense in conjunction with at least a defined window1 ,
if none is defined window1 = [0.5,10,300,1200] will be set automatically</p>
</p></li>
<li><p><strong>data_type</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – data_type is the string that represents the intensity measurements. Usually this contains if absolute
of differential data. This is used for the color intensity in the 2d plots and the y-axis for the 1d plots</p></li>
<li><p><strong>units</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – this is used to identify the units on the energy axis and to label the slices, recognized is ‘nm’, ‘eV’ and ‘keV’
but if another unit like ‘cm^-1’ is used it will state energy in ‘cm^-1’. Pleas observe that if you use the index_is_energy
switch the program tries to convert this energy into wavelength.</p></li>
<li><p><strong>save_name</strong> (<em>str</em><em>, </em><em>optional</em>) – specify name for saving the combined scans (Default) ‘combined.SIA’)</p></li>
<li><p><strong>return_removed_list</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) False, returns the list of removed scans instead of the averaged data set. (this list could then be given as “list_to_dump” to get the averaged datafile too. If a file name is given for saved file (which is Default) then the file is saved anyways.</p></li>
<li><p><strong>sep</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – is the separator between different numbers, typical are tap (Backslash t) (Default) ,one or
multiple white spaces ‘backslash s+’ or comma ‘,’.</p></li>
<li><p><strong>decimal</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – sets the ascii symbol that is used for the decimal sign. In most countries this is ‘.’(Default)
but it can be ‘,’ in countries like Sweden or Germany</p></li>
<li><p><strong>index_is_energy</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – switches if the wavelength is given in nm (Default) or in eV (if True), currently everything
is handled as wavelength in nm internally</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – if this switch is False (Default) the wavelength are the columns and the rows the times.</p></li>
<li><p><strong>sort_indexes</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – For False (Default) I assume that the times and energies are already in a rising order.
with this switch, both are sorted again.</p></li>
<li><p><strong>divide_times_by</strong> (<em>bool</em><em> or </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – here a number can be given that scales the time by an arbitary factor. This is actually dividing
the times by this value. Alternatively there is the variable self.baseunit. The latter only affects
what is written on the axis, while this value is actually used to scale the times. False (Default)
ignores this</p></li>
<li><p><strong>shift_times_by</strong> (<em>None</em><em>, </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – This a value by which the time axis is shifted during import. This is a useful option of e.g.
the recording software does not compensate for t0 and the data is always shifted.
None (Default) ignores this setting</p></li>
<li><p><strong>external_time</strong> (<em>None</em><em> or </em><em>str</em><em> (</em><em>optional</em><em>)</em>) – Here a filename extension (string) can be given that contains the time vector.
The file is assumed to be at the same path as the data and to contain a single
type of separated data without header. It also assumes that this is the ending
for the file. The filename itself is taken from the filename.
e.g. if samp1.txt is the filename and external_time=’.tid’ the program searches
samp1.tid for the times. The transpose setting is applied and sets where the times are
to be inserted (row or column indexes)</p></li>
<li><p><strong>external_wave</strong> (<em>None</em><em> or </em><em>str</em><em> (</em><em>optional</em><em>)</em>) – Here a filename extension (string) can be given that contains the wavelength vector.
The file is assumed to be at the same path as the data and to contain a single type
of separated data without header. This is the ending for the file. The filename itself
is taken from the filename. e.g. if samp1.txt is the filename and external_wave=’.wav’
then the program searches samp1.wav for the wavelength. The transpose setting is applied
and sets where the wavelength are to be inserted (columns or row indexes)</p></li>
<li><p><strong>return_ds_only</strong> (<em>boolean</em><em>,</em><em>(</em><em>optional</em><em>)</em>) – if False (Dafault) returns a TA object, otherwise just a DataFrame</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>TA object if return_ds_only is False(Default) averaged dataset (ds) of the selected scans or</em></p></li>
<li><p><em>(if return_removed_list = True) the list of removed scans.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Use use a range to select the rejected scans, look on the scans by integrating the window 0.5ps to 1ps and 450nm to 470nm</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plot_func</span> <span class="k">as</span> <span class="nn">pf</span> <span class="c1">#import the module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">window1</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">450</span><span class="p">,</span><span class="mi">470</span><span class="p">]</span> <span class="c1">#define the window</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#use a &#39;GUI&#39; to select the files</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf</span><span class="o">.</span><span class="n">Summarize_scans</span><span class="p">(</span><span class="n">list_of_scans</span><span class="o">=</span><span class="s1">&#39;gui&#39;</span><span class="p">,</span><span class="n">window1</span><span class="o">=</span><span class="n">window1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#use all scans in the subfolder scans that have the word &#39;Scan&#39; in them and use the ending &#39;SIA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf</span><span class="o">.</span><span class="n">Summarize_scans</span><span class="p">(</span><span class="n">path_to_scans</span> <span class="o">=</span> <span class="s1">&#39;Scans&#39;</span><span class="p">,</span> <span class="n">filepart_name</span> <span class="o">=</span> <span class="s1">&#39;Scan&#39;</span><span class="p">,</span> <span class="n">window1</span><span class="o">=</span><span class="n">window1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#This does the same as these are standard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf</span><span class="o">.</span><span class="n">Summarize_scans</span><span class="p">(</span><span class="n">window1</span><span class="o">=</span><span class="n">window1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="plot_func.build_c">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">build_c</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">mod</span><span class="o">=</span><span class="default_value">'paral'</span></em>, <em class="sig-param"><span class="n">pardf</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sub_steps</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#build_c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.build_c" title="Permalink to this definition">¶</a></dt>
<dd><p>Build concentration matrix after model the parameters are:
resolution is the width of the rise time (at sigma 50% intensity)
This function can also be used to create illustration dynamics.
The parallel decays are created explicit, while the consecutive decays are
created by sampling the populations at the times given in the first vector and
evaluate the progression at a number of substeps defined bu sub_samples (10 by default)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>np.array</em>) – array with the times at which the dataframe should be generated. In general the
experimental times</p></li>
<li><p><strong>mod</strong> (<em>str</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>this selects the model that is used to generate the concentrations.</dt><dd><ol class="arabic simple">
<li><p>’paral’ (Default) or ‘exponential’ both are equivalent</p></li>
<li><p>’consecutive’ or ‘full_consecutive’</p></li>
</ol>
</dd>
</dl>
<p>In 2 the ‘consecutive’ and ‘full_consecutive’ are different in that for consecutive
the optimization is done using ‘exponential’ (as it shoudl give the same times)
and then only in the last (final) iteration the ‘full consecutive’ differential
equation is used. This has significant speed advantages, but can lead to errors particularly
for the very fast times.</p>
</p></li>
<li><p><strong>sub_step</strong> (<em>int</em><em>, </em><em>optional</em>) – defines how many times the iterative loop (used in consecutive only) is sampling the concentrations
between the times given in “times”</p></li>
<li><p><strong>pardf</strong> (<em>pd.DataFrame</em>) – <p>This dataframe must contain the parameter that are used for creating the dynamics
the parameter must be named with the index.
For the internal functions this must contain these keys:</p>
<blockquote>
<div><ul>
<li><p>’t0’ = zero time, mandatory</p></li>
<li><p>’resolution’ = instrument response function, mandatory</p></li>
<li><p>’background’,optional = if this keyword is present a flat constant background is created (=1 over the whole time)</p></li>
<li><p>’infinite’,optional = if this keyword is present a new non decaying component is formed with the last decay time.</p></li>
<li><p>’k0,k1,…’ = with increasing integers are taken as decay times. te number of these components is used to determine how many shall be generated.</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
</dd></dl>

<dl class="py function">
<dt id="plot_func.changefonts">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">changefonts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weight</span><span class="o">=</span><span class="default_value">'bold'</span></em>, <em class="sig-param"><span class="n">font</span><span class="o">=</span><span class="default_value">'standard'</span></em>, <em class="sig-param"><span class="n">SMALL_SIZE</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">MEDIUM_SIZE</span><span class="o">=</span><span class="default_value">13</span></em>, <em class="sig-param"><span class="n">LARGE_SIZE</span><span class="o">=</span><span class="default_value">18</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#changefonts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.changefonts" title="Permalink to this definition">¶</a></dt>
<dd><p>Small function that sets the matplotlib font sizes and fonts, written as conveniens to not need to remember all the
codes and what is names what. Calling the function will change the matplotlib <em>rc</em> settings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘bold’ or  ‘normal’</p></li>
<li><p><strong>font</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>this is a meta switch that changes the family. known are:
‘standard’=’DejaVu Sans’</p>
<p>’arial’=’Arial’</p>
<p>’helvetica’= ‘Helvetica’</p>
<p>’garamond’=’Garamond’</p>
<p>’verdana’=’Verdana’</p>
<p>’bookman’=’Bookman’</p>
<p>’times’=’Times New Roman’</p>
</p></li>
<li><p><strong>SMALL_SIZE</strong> (<em>int</em><em>, </em><em>optional</em>) – <p>(DEFAULT = 11)</p>
<p>all written text, legend title and face size</p>
</p></li>
<li><p><strong>MEDIUM_SIZE</strong> (<em>int</em><em>, </em><em>optional</em>) – <p>(DEFAULT = 13)</p>
<p>tick size and tick numbers</p>
</p></li>
<li><p><strong>LARGE_SIZE</strong> (<em>int</em><em>, </em><em>optional</em>) – <p>(DEFAULT = 18)</p>
<p>axis titles, figure titles, axis labels</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.err_func">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">err_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">paras</span></em>, <em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">mod</span><span class="o">=</span><span class="default_value">'paral'</span></em>, <em class="sig-param"><span class="n">final</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log_fit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dump_paras</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_spectra</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#err_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.err_func" title="Permalink to this definition">¶</a></dt>
<dd><p>function that calculates and returns the error for the global fit. This function is intended for
fitting a single dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>DataFrame</em>) – This dataframe contains the data to be fitted. This has to be shaped as it is intended to (so all shping parameters
already applied. The dataframe expects the time to be in Index and the wavelength/energy
to be in the columns. The spectra is plotted with a second (energy) axis</p></li>
<li><p><strong>paras</strong> (<em>lmfit parameter oject</em>) – The parameter object that defines what is calculated</p></li>
<li><p><strong>mod</strong> (<em>str</em><em> or </em><em>function</em><em>, </em><em>optional</em>) – <p>The model selection is depending if it is an internal or external model.
The internal functions are triggered by calling their name
Two main are currently implemented</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>’paral’ (Default) or ‘exponential’</p></li>
<li><p>’consecutive’ or ‘full_consecutive’</p></li>
</ol>
</div></blockquote>
<p>In 2 the ‘consecutive’ and ‘full_consecutive’ are different in that for consecutive
the optimization is done using ‘exponential’ (as it shoudl give the same times)
and then only in the last (final) iteration the ‘full consecutive’ differential
equation is used. This has significant speed advantages, but can lead to errors particularly
for the very fast times.</p>
<p>As external model a function is handed to this parameter, this function
must accept the times and an paramater Dataframe and return a DataFrame
with the concentrations (similar to build_c)</p>
<p>for the internal functions:
This datafram must contain the parameter that are used for creadting the dynamics
the parameter must be named with the index.
‘t0’ = zero time, mandatory
‘resolution’ = instrument response function, mandatory
‘background’,optional = if this keyword is present a flat constant background is created (=1 over the whole time)
‘infinite’,optional = if this keyword is present a new non decaying component is formed with the last decay time.
‘k0,k1,…’ = with increasing integers are taken as decay times. te number of these components is used to determine how many shall be generated.</p>
</p></li>
<li><p><strong>final</strong> (<em>bool</em><em>, </em><em>optional</em>) – this switch decides if just the squared error is returned (for False) (Default) or if the full
matrixes are returned, including the r2 are returned.</p></li>
<li><p><strong>log_fit</strong> (<em>bool</em><em>, </em><em>optional</em>) – if False (Default) then the parameter are handed to the fitting function as they are, if true
then all times are first converted to log space.</p></li>
<li><p><strong>dump_paras</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) is False, If True creates two files in the working folder, one with the
currently used parameter created at the end of each optimisation step, and one with
the set of parameter that up to now gave the lowest error. Intented to store
the optimisation results if the fit needs to be interrupted
(if e.g. Ampgo simply needs to long to optimize.) useful option if things are slow</p></li>
<li><p><strong>filename</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Only used in conjunction with ‘dump_paras’. The program uses this filename to dump the
parameter to disk</p></li>
<li><p><strong>ext_spectra</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – (Default) is None, if given substract this spectra from the DataMatrix using the intensity
given in “C(t)” this function will only work for external models. The name of the spectral column
must be same as the name of the column used. If not the spectrum will be ignored. The spectrum will
be interpolated to the spectral points of the model ds before the substraction.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.err_func_multi">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">err_func_multi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">paras</span></em>, <em class="sig-param"><span class="n">mod</span><span class="o">=</span><span class="default_value">'paral'</span></em>, <em class="sig-param"><span class="n">final</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log_fit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">multi_project</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">unique_parameter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dump_paras</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext_spectra</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#err_func_multi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.err_func_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>function that calculates and returns the error for the global fit. This function is intended for
fitting of multiple datasets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paras</strong> (<em>lmfit parameter oject</em>) – The parameter object that defines what is calculated</p></li>
<li><p><strong>mod</strong> (<em>str</em><em> or </em><em>function</em><em>, </em><em>optional</em>) – <p>The model selection is depending if it is an internal or external model.
The internal functions are triggered by calling their name
Two main are currently implemented</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>’paral’ (Default) or ‘exponential’</p></li>
<li><p>’consecutive’ or ‘full_consecutive’</p></li>
</ol>
</div></blockquote>
<p>In 2 the ‘consecutive’ and ‘full_consecutive’ are different in that for consecutive
the optimization is done using ‘exponential’ (as it shoudl give the same times)
and then only in the last (final) iteration the ‘full consecutive’ differential
equation is used. This has significant speed advantages, but can lead to errors particularly
for the very fast times.</p>
<p>for the internal functions:
This datafram must contain the parameter that are used for creadting the dynamics
the parameter must be named with the index.
‘t0’ = zero time, mandatory
‘resolution’ = instrument response function, mandatory
‘background’,optional = if this keyword is present a flat constant background is created (=1 over the whole time)
‘infinite’,optional = if this keyword is present a new non decaying component is formed with the last decay time.
‘k0,k1,…’ = with increasing integers are taken as decay times. te number of these components is used to determine how many shall be generated.</p>
<p>As external model a function is handed to this parameter, this function
must accept the times and an paramater Dataframe and return a DataFrame
with the concentrations (similar to build_c)</p>
</p></li>
<li><p><strong>final</strong> (<em>bool</em><em>, </em><em>optional</em>) – this switch decides if just the squared error is returned (for False) (Default) or if the full
matrixes are returned, including the r2 are returned.</p></li>
<li><p><strong>log_fit</strong> (<em>bool</em><em>, </em><em>optional</em>) – if False (Default) then the parameter are handed to the fitting function as they are, if true
then all times are first converted to log space.</p></li>
<li><p><strong>dump_paras</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) is False, If True creates two files in the working folder, one with the
currently used parameter created at the end of each optimisation step, and one with
the set of parameter that up to now gave the lowest error. Intented to store
the optimisation results if the fit needs to be interrupted
(if e.g. Ampgo simply needs to long to optimize.) useful option if things are slow</p></li>
<li><p><strong>filename</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Only used in conjunction with ‘dump_paras’. The program uses this filename to dump the
parameter to disk</p></li>
<li><p><strong>multi_project</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of TA projects</em><em>)</em><em>, </em><em>optional</em>) – This switch is triggering the simultaneous optimisation of multiple datasets.
multi_project is as (Default) None. it expects an iterable (typically list) with other
TA projects (like ta) that are then optimised with the same parameter.
This means that all projects get the same parameter object for each iteration
of the fit and return their individual error, which is summed linearly.
The “weights” option allows to give each multi_project a specific weight (number)
that is multiplied to the error. If the weight object has the same number of items
as the multi_project it is assumed that the triggering object (the embedded project)
has the weight of 1, otherwise the first weight is for the embedded project.
The option ‘unique_parameter’ takes (a list) of parameter that are not
to be shared between the projects (and that are not optimized either)
The intended use of this is to give e.g. the pump power for multiple experiments to
study non linear behaviour. Returned will be only the parameter set for the optimium
combination of all parameter. Internally, we iterate through the projects and calculate
for each project the error for each iteration. Important to note is that currently this
means that each DAS/SAS is calculated independently! For performing the same calculation
with a single DAS, the Matrixes need to be concatenated before the run and an external
function used to create a combined model. As this is very difficult to implement reliably
For general use (think e.g. different pump wavelength) this has to be done manually.</p></li>
<li><p><strong>unique_parameter</strong> (<em>None</em><em> or </em><em>str</em><em> or </em><em>list</em><em> (</em><em>of strings</em><em>)</em><em>, </em><em>optional</em>) – only used in conjunction with ‘multi_project’, it takes (a list) of parameter that
are not to be shared between the projects (and that are not optimized either)
The intended use of this is to give e.g. the pump power for multiple experiments
to study non linear behaviour. (Default) None</p></li>
<li><p><strong>weights</strong> (<em>list of floats</em><em>, </em><em>optional</em>) – only used in conjunction with ‘multi_project’. The “weights” option allows to
give each multi_project a specific weight (number) that is multiplied to the error.
If the weight object has the same number of items as the ‘multi_project’ it is assumed
that ta (the embedded project) has the weight of 1, otherwise the first weight is for the
embedded object</p></li>
<li><p><strong>ext_spectra</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – (Default) is None, if given substract this spectra from the DataMatrix using the intensity
given in “C(t)” this function will only work for external models. The name of the spectral column
must be same as the name of the column used. If not the spectrum will be ignored. The spectrum will
be interpolated to the spectral points of the model ds before the substraction.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.fill_int">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">fill_int</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">final</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">baseunit</span><span class="o">=</span><span class="default_value">'ps'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#fill_int"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.fill_int" title="Permalink to this definition">¶</a></dt>
<dd><p>solving_equation_way,</p>
</dd></dl>

<dl class="py function">
<dt id="plot_func.norm">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">norm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Min max norming of a dataframe</p>
</dd></dl>

<dl class="py function">
<dt id="plot_func.plot1d">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">plot1d</code><span class="sig-paren">(</span><em class="sig-param">ds=None</em>, <em class="sig-param">wavelength=None</em>, <em class="sig-param">width=None</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">subplot=False</em>, <em class="sig-param">title=None</em>, <em class="sig-param">intensity_range=None</em>, <em class="sig-param">baseunit='ps'</em>, <em class="sig-param">timelimits=None</em>, <em class="sig-param">scattercut=None</em>, <em class="sig-param">bordercut=None</em>, <em class="sig-param">cmap=&lt;matplotlib.colors.ListedColormap object&gt;</em>, <em class="sig-param">plot_type='symlog'</em>, <em class="sig-param">lintresh=0.1</em>, <em class="sig-param">text_in_legend=None</em>, <em class="sig-param">lines_are='smoothed'</em>, <em class="sig-param">color_offset=0</em>, <em class="sig-param">ignore_time_region=None</em>, <em class="sig-param">linewidth=1</em>, <em class="sig-param">data_type='differential Absorption in $\\mathregular{\\Delta OD}$'</em>, <em class="sig-param">units='nm'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#plot1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.plot1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the single line kinetic for specific wavelength given with the parameter wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>DataFrame</em>) – This dataframe contains the data to be plotted. It is copied and sliced into the
regions defined. The dataframe expects the time to be in Index and the wavelength/energy
to be in the columns. The spectra is plotted with a second (energy) axis</p></li>
<li><p><strong>wavelength</strong> (<em>float</em><em> or </em><em>list</em><em> (</em><em>of floats</em><em>)</em>) – wavelength is in the object called “rel_wave” and works with “width”
(in the object called “wavelength_bin”) together for the creation
of kinetic plots. When plotting kinetic spectra one line will be plotted for each entrance
in the list/vector rel_wave. During object generation the vector np.arange(300,1000,100)
is set as standard. Another typical using style would be to define a list of interesting
wavelength at which a kinetic development is to be plotted. At each selected wavelength
the data between wavelength+ta.wavelength_bin and wavelength-ta.wavelength_bin is averaged
for each timepoint returned</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – this is the datatype and effectively the unit put on the intensity axis
(Default)’differential Absorption in $mathregular{Delta OD}$</p></li>
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – the width used in kinetics, see below (Default) 10nm</p></li>
<li><p><strong>ax</strong> (<em>None</em><em>, </em><em>matplotlib axis object optional</em>) – If None (Default) a new plot is is created and a new axis, otherwise ax needs to be Matplotlib Axis</p></li>
<li><p><strong>subplot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False (Default) axis labels and such are set. If True, we plot into the same axis and
do not set labels</p></li>
<li><p><strong>text_in_legend</strong> (<em>None</em><em>, </em><em>str</em><em>, </em><em>optional</em>) – extra text to be put into the legend (above the lines)</p></li>
<li><p><strong>lines_are</strong> (<em>str</em><em>, </em><em>optional</em>) – Depending on this parameter the plots contain:
‘smoothed’ = data lines of golay smoothed data (Default)
‘data’ = dots are data,
‘fitted’ = not data, just lines shown</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em>) – title to be used on top of each plot
The (Default) None triggers  self.filename to be used. Setting a specific title as string will
be used in all plots. To remove the title all together set an empty string</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – linewidht to be used for plotting</p></li>
<li><p><strong>intensity_range</strong> (<em>None</em><em>, </em><em>float</em><em> or </em><em>list</em><em> [</em><em>of two floats</em><em>]</em>) – intensity_range is a general switch that governs what intensity range the plots show.
For the 1d plots this is the y-axis for the 2d-plots this is the colour scale.
This parameter recognizes three settings. If set to “None” (Default) this uses the minimum and
maximum of the data. A single value like in the example below and the intended use is the symmetric
scale while a list with two entries an assymmetric scale e.g.
intensity_range=3e-3 is converted into intensity_range=[-3e-3,3e-3]</p></li>
<li><p><strong>baseunit</strong> (<em>str</em>) – baseunit is a neat way to change the unit on the time axis of the plots. (Default) ‘ps’, but they
can be frames or something similarly. This is changing only the label of the axis.
During the import there is the option to divide the numbers by a factor.
I have also used frames or fs as units. Important is that all time units will be labeled with
this unit.</p></li>
<li><p><strong>timelimits</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of 2 floats</em><em>)</em><em>, </em><em>optional</em>) – cut times at the low and high time limit. (Default) None uses the limits of measurement
Important: If either the background or the chirp is to be fit this must include the
time before zero! Useful: It is useful to work on different regions, starting with
the longest (then use the ta.Backgound function prior to fit) and expand from there</p></li>
<li><p><strong>scattercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>of floats</em><em> or </em><em>other iterable</em><em>, </em><em>always pairs!</em><em>)</em><em>, </em><em>optional</em>) – intented to “cut” one or multiple scatter regions. (if (Default) None nothing
happens) If it is set the spectral region between the limits is set to zero.
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>bordercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>with two floats</em><em>)</em><em>, </em><em>optional</em>) – cut spectra at the low and high wavelength limit. (Default) None
uses the limits of measurement</p></li>
<li><p><strong>ignore_time_region</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of two floats</em><em> or </em><em>of lists</em><em>)</em><em>, </em><em>optional</em>) – cut set a time range with a low and high limit from the fits. (Default) None nothing happens
The region will be removed during the fitting process (and will be missing in the fit-result
plots)
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
<li><p><strong>color_offset</strong> (<em>int</em><em>, </em><em>optional</em>) – At the (Default) 0 the colours are chose from the beginning, for a larger value Color_offset
colors are skipped. Usually only used if multiple plots are created, and the data/or fit is
only shown for some of them.</p></li>
<li><p><strong>plot_type</strong> (<em>None</em><em> or </em><em>str</em>) – is a general setting that can influences what time axis will be used for the plots.
“symlog” (linear around zero and logarithmic otherwise) “lin” and “log” are valid options.</p></li>
<li><p><strong>lintresh</strong> (<em>float</em>) – The pseudo logratihmic range “symlog” is used for most time axis. Symlog plots a range around
time zero linear and beyond this linear treshold ‘lintresh’ on a logarithmic scale. (Default) 0.3</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.plot2d">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">plot2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">intensity_range</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">baseunit</span><span class="o">=</span><span class="default_value">'ps'</span></em>, <em class="sig-param"><span class="n">timelimits</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scattercut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bordercut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wave_nm_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_time_region</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_scale</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot_type</span><span class="o">=</span><span class="default_value">'symlog'</span></em>, <em class="sig-param"><span class="n">lintresh</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">wavelength_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">levels</span><span class="o">=</span><span class="default_value">256</span></em>, <em class="sig-param"><span class="n">use_colorbar</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">'differential Absorption in $\\mathregular{\\Delta OD}$'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#plot2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.plot2d" title="Permalink to this definition">¶</a></dt>
<dd><p>function for plotting matrix of TA data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>DataFrame</em>) – This dataframe contains the data to be plotted. It is copied and sliced into the
regions defined. The dataframe expects the time to be in Index and the wavelength/energy
to be in the columns. The spectra is plotted with a second (energy) axis</p></li>
<li><p><strong>ax</strong> (<em>None</em><em>, </em><em>matplotlib axis object optional</em>) – If None (Default) a new plot is is created and a new axis, otherwise ax needs to be Matplotlib Axis</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – this is the datatype and effectively the unit put on the intensity axis
(Default)’differential Absorption in $mathregular{Delta OD}$</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em>) – title to be used on top of each plot
The (Default) None triggers  self.filename to be used. Setting a specific title as string will
be used in all plots. To remove the title all together set an empty string with this command title=””</p></li>
<li><p><strong>intensity_range</strong> (<em>None</em><em>, </em><em>float</em><em> or </em><em>list</em><em> [</em><em>of two floats</em><em>]</em>) – intensity_range is a general switch that governs what intensity range the plots show.
For the 1d plots this is the y-axis for the 2d-plots this is the colour scale.
This parameter recognizes three settings. If set to “None” (Default) this uses the minimum and
maximum of the data. A single value like in the example below and the intended use is the symmetric
scale while a list with two entries an assymmetric scale e.g.
intensity_range=3e-3 is converted into intensity_range=[-3e-3,3e-3]</p></li>
<li><p><strong>baseunit</strong> (<em>str</em>) – baseunit is a neat way to change the unit on the time axis of the plots. (Default) ‘ps’, but they
can be frames or something similarly. This is changing only the label of the axis.
During the import there is the option to divide the numbers by a factor.
I have also used frames or fs as units. Important is that all time units will be labeled with
this unit.</p></li>
<li><p><strong>timelimits</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of 2 floats</em><em>)</em><em>, </em><em>optional</em>) – cut times at the low and high time limit. (Default) None uses the limits of measurement
Important: If either the background or the chirp is to be fit this must include the
time before zero! Useful: It is useful to work on different regions, starting with
the longest (then use the ta.Backgound function prior to fit) and expand from there</p></li>
<li><p><strong>scattercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>of floats</em><em> or </em><em>other iterable</em><em>, </em><em>always pairs!</em><em>)</em><em>, </em><em>optional</em>) – intented to “cut” one or multiple scatter regions. (if (Default) None nothing
happens) If it is set the spectral region between the limits is set to zero.
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>bordercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>with two floats</em><em>)</em><em>, </em><em>optional</em>) – cut spectra at the low and high wavelength limit. (Default) None
uses the limits of measurement</p></li>
<li><p><strong>wave_nm_bin</strong> (<em>None</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – rebins the original data into even intervals. If set to None the original data will be used.
If set to a width (e.g. 2nm), the wavelength axis will be divided into steps of this size
and the mean of all measurements in the interval is taken. The re-binning stops as soon as
the measured stepsize is wider than given here, then the original bins are used.
This function is particularly useful for spectrometer with non-linear dispersion,
like a prism in the infrared.</p></li>
<li><p><strong>ignore_time_region</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of two floats</em><em> or </em><em>of lists</em><em>)</em><em>, </em><em>optional</em>) – cut set a time range with a low and high limit from the fits. (Default) None nothing happens
The region will be removed during the fitting process (and will be missing in the fit-result
plots)
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>time_bin</strong> (<em>None</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – is dividing the points on the time-axis in even bins and averages the found values in between.
This is a hard approach that also affects the fits. I do recommend to use this carefully,
it is most useful for modulated data. A better choice for transient absorption that only
affects the kinetics is ‘time_width_percent’</p></li>
<li><p><strong>log_scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True (Default), The 2D plots (Matrix) is plotted with a pseudo logarithmic intensity scale.
This usually does not give good results unless the intensity scale is symmetric</p></li>
<li><p><strong>plot_type</strong> (<em>None</em><em> or </em><em>str</em>) – is a general setting that can influences what time axis will be used for the plots.
“symlog” (linear around zero and logarithmic otherwise) “lin” and “log” are valid options.</p></li>
<li><p><strong>lintresh</strong> (<em>float</em>) – The pseudo logratihmic range “symlog” is used for most time axis. Symlog plots a range around
time zero linear and beyond this linear treshold ‘lintresh’ on a logarithmic scale. (Default) 0.3</p></li>
<li><p><strong>wavelength_bin</strong> (<em>float</em><em>, </em><em>optional</em>) – the width used in kinetics, see below (Default) 10nm</p></li>
<li><p><strong>levels</strong> (<em>int</em><em>, </em><em>optional</em>) – how many different colours to use in the description. less makes for more contrast but less
intensity details (Default) 256</p></li>
<li><p><strong>use_colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True (Default) a colour bar is added to the 2d plot for intensity explanation, switch
mostely used for creating multiple plots</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.plot2d_fit">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">plot2d_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">re</span></em>, <em class="sig-param"><span class="n">error_matrix_amplification</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">use_images</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">patches</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">intensity_range</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">baseunit</span><span class="o">=</span><span class="default_value">'ps'</span></em>, <em class="sig-param"><span class="n">timelimits</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scattercut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bordercut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wave_nm_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_time_region</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_scale</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">scale_type</span><span class="o">=</span><span class="default_value">'symlog'</span></em>, <em class="sig-param"><span class="n">lintresh</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">wavelength_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">levels</span><span class="o">=</span><span class="default_value">256</span></em>, <em class="sig-param"><span class="n">plot_with_colorbar</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">'differential Absorption in $\\mathregular{\\Delta OD}$'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#plot2d_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.plot2d_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the fit output as a single plot with meas,fitted and difference.
The differnece used err_matrix_amplification as a factor. patches moves the labels from the
title into white patches in the top of the figure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>re</strong> (<em>dict</em>) – Dictionary that contains the fit results and  specific the dataframes A, AC and AE</p></li>
<li><p><strong>error_matrix_amplification</strong> (<em>int</em><em>, </em><em>optional</em>) – the error matrix AE is multiplied by this factor for the plot.</p></li>
<li><p><strong>use_images</strong> (<em>bool:</em>) – (Default)True converts the matrix into images, to reduce the filesize.</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – this is the datatype and effectively the unit put on the intensity axis
(Default)’differential Absorption in $mathregular{Delta OD}$</p></li>
<li><p><strong>patches</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False (Default) the names “measured” “fitted” “difference” will be placed above the images.
If True, then they will be included into the image (denser)</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em>) – title to be used on top of each plot
The (Default) None triggers  self.filename to be used. Setting a specific title as string will
be used in all plots. To remove the title all together set an empty string with this command title=””</p></li>
<li><p><strong>intensity_range</strong> (<em>None</em><em>, </em><em>float</em><em> or </em><em>list</em><em> [</em><em>of two floats</em><em>]</em>) – intensity_range is a general switch that governs what intensity range the plots show.
For the 1d plots this is the y-axis for the 2d-plots this is the colour scale.
This parameter recognizes three settings. If set to “None” (Default) this uses the minimum and
maximum of the data. A single value like in the example below and the intended use is the symmetric
scale while a list with two entries an assymmetric scale e.g.
intensity_range=3e-3 is converted into intensity_range=[-3e-3,3e-3]</p></li>
<li><p><strong>baseunit</strong> (<em>str</em>) – baseunit is a neat way to change the unit on the time axis of the plots. (Default) ‘ps’, but they
can be frames or something similarly. This is changing only the label of the axis.
During the import there is the option to divide the numbers by a factor.
I have also used frames or fs as units. Important is that all time units will be labeled with
this unit.</p></li>
<li><p><strong>timelimits</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of 2 floats</em><em>)</em><em>, </em><em>optional</em>) – cut times at the low and high time limit. (Default) None uses the limits of measurement
Important: If either the background or the chirp is to be fit this must include the
time before zero! Useful: It is useful to work on different regions, starting with
the longest (then use the ta.Backgound function prior to fit) and expand from there</p></li>
<li><p><strong>scattercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>of floats</em><em> or </em><em>other iterable</em><em>, </em><em>always pairs!</em><em>)</em><em>, </em><em>optional</em>) – intented to “cut” one or multiple scatter regions. (if (Default) None nothing
happens) If it is set the spectral region between the limits is set to zero.
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>bordercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>with two floats</em><em>)</em><em>, </em><em>optional</em>) – cut spectra at the low and high wavelength limit. (Default) None
uses the limits of measurement</p></li>
<li><p><strong>wave_nm_bin</strong> (<em>None</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – rebins the original data into even intervals. If set to None the original data will be used.
If set to a width (e.g. 2nm), the wavelength axis will be divided into steps of this size
and the mean of all measurements in the interval is taken. The re-binning stops as soon as
the measured stepsize is wider than given here, then the original bins are used.
This function is particularly useful for spectrometer with non-linear dispersion,
like a prism in the infrared.</p></li>
<li><p><strong>ignore_time_region</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of two floats</em><em> or </em><em>of lists</em><em>)</em><em>, </em><em>optional</em>) – cut set a time range with a low and high limit from the fits. (Default) None nothing happens
The region will be removed during the fitting process (and will be missing in the fit-result
plots)
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>time_bin</strong> (<em>None</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – is dividing the points on the time-axis in even bins and averages the found values in between.
This is a hard approach that also affects the fits. I do recommend to use this carefully,
it is most useful for modulated data. A better choice for transient absorption that only
affects the kinetics is ‘time_width_percent’</p></li>
<li><p><strong>log_scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True (Default), The 2D plots (Matrix) is plotted with a pseudo logarithmic intensity scale.
This usually does not give good results unless the intensity scale is symmetric</p></li>
<li><p><strong>Scale_type</strong> (<em>None</em><em> or </em><em>str</em>) – is a general setting that can influences what time axis will be used for the plots.
“symlog” (linear around zero and logarithmic otherwise) “lin” and “log” are valid options.</p></li>
<li><p><strong>lintresh</strong> (<em>float</em>) – The pseudo logratihmic range “symlog” is used for most time axis. Symlog plots a range around
time zero linear and beyond this linear treshold ‘lintresh’ on a logarithmic scale. (Default) 0.3</p></li>
<li><p><strong>wavelength_bin</strong> (<em>float</em><em>, </em><em>optional</em>) – the width used in kinetics, see below (Default) 10nm</p></li>
<li><p><strong>levels</strong> (<em>int</em><em>, </em><em>optional</em>) – how many different colours to use in the description. less makes for more contrast but less
intensity details (Default) 256</p></li>
<li><p><strong>plot_with_colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True (Default) a colour bar is added to the 2d plot for intensity explanation, switch
mostely used for creating multiple plots</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.plot_fit_output">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">plot_fit_output</code><span class="sig-paren">(</span><em class="sig-param">re, ds, cmap=&lt;matplotlib.colors.ListedColormap object&gt;, plotting=range(0, 6), title=None, path=None, filename=None, f='standard', intensity_range=0.01, baseunit='ps', timelimits=None, scattercut=None, bordercut=None, error_matrix_amplification=20, wave_nm_bin=5, rel_wave=None, width=10, rel_time=[1, 5, 10], time_width_percent=10, ignore_time_region=None, save_figures_to_folder=True, log_fit=False, mod=None, subplot=False, color_offset=0, log_scale=True, savetype='png', evaluation_style=False, lintresh=1, scale_type='symlog', patches=False, print_click_position=False, data_type='differential Absorption in $\\mathregular{\\Delta OD}$', plot_second_as_energy=True, units='nm'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#plot_fit_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.plot_fit_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Purly manual function that plots all the fit output figures. Quite cumbersome,
but offers a lot of manual options. The figures can be called separately
or with a list of plots. e.g. range(6) call plots 0-5 Manual plotting of certain type:
This is a wrapper function that triggers the plotting of all the fitted plots.
The parameter in this plot call are to control the general look and features of the plot.
Which plots are printed is defined by the command (plotting)
The plots are generated from the fitted Matrixes and as such only will work after a fit was actually
completed (and the “re” dictionary attached to the object.)
In all plots the RAW data is plotted as dots and the fit with lines</p>
<p><em>Contents of the plots</em></p>
<ol class="arabic simple" start="0">
<li><p>DAC contains the assigned spectra for each component of the fit. For
a modelling with independent exponential decays this corresponds to
the “Decay Associated Spectra” (DAS). For all other models this
contains the “Species Associated Spectra” (SAS). According to the
model the separate spectra are labeled by time (process) or name, if
a name is associated in the fitting model. The spectra are shown in
the extracted strength in the right pane and normalized in the left.
Extracted strength means that the measured spectral strength is the
intensity (concentration matrix) times this spectral strength. As the
concentration maxima for all DAS are 1 this corresponds to the
spectral strength for the DAS. (please see the documentation for the
fitting algorithm for further details)</p></li>
<li><p>summed intensity. All wavelength of the spectral axis are summed for
data and fit. The data is plotted in a number of ways vs linear and
logarithmic axis. This plot is not ment for publication but very
useful to evaluate the quality of a fit.</p></li>
<li><p>plot kinetics for selected wavelength (see corresponding RAW plot)</p></li>
<li><p>plot spectra at selected times (see corresponding RAW plot)</p></li>
<li><p>plots matrix (measured, modelled and error Matrix). The parameter are
the same as used for the corresponding RAW plot with the addition of
“error_matrix_amplification” which is a scaling factor multiplied
onto the error matrix. I recommend to play with different “cmap”,
“log_scale” and “intensity_scale” to create a pleasing plot</p></li>
<li><p>concentrations. In the progress of the modelling/fitting a matrix is
generated that contains the relative concentrations of the species
modelled. This plot is showing the temporal development of these
species. Further details on how this matrix is generated can be found
in the documentation of the fitting function. The modeled spectra are
the convolution of these vectors (giving the time-development) and
the DAS/SAS (giving the spectral development).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>DataFrame</em>) – This dataframe contains the data to be plotted. It is copied and sliced into the
regions defined. The dataframe expects the time to be in Index and the wavelength/energy
to be in the columns. The spectra is plotted with a second (energy) axis</p></li>
<li><p><strong>re</strong> (<em>dict</em>) – Dictionary that contains the fit results and  specific the dataframes A, AC and AE</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – this is the datatype and effectively the unit put on the intensity axis
(Default)’differential Absorption in $mathregular{Delta OD}$</p></li>
<li><p><strong>error_matrix_amplification</strong> (<em>int</em><em>, </em><em>optional</em>) – the error matrix AE is multiplied by this factor for the plot.</p></li>
<li><p><strong>plotting</strong> (<em>int</em><em> or </em><em>iterable</em><em> (</em><em>of integers</em><em>)</em><em>, </em><em>optional</em>) – This parameter determines which figures are plotted
the figures can be called separately with plotting = 1
or with a list of plots (Default) e.g.~plotting=range(6) calls plots 0,1,2,3,4,5
The plots have the following numbers:           0 - DAS or SAS          1 - summed intensity            2 - Kinetics            3 - Spectra             4 - Matrixes            5 - Concentrations (the c-object)               The plotting takes all parameter from the “ta” object unless otherwise specified</p></li>
<li><p><strong>path</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>path object</em><em>, </em><em>optional</em>) – This defines where the files are saved if the safe_figures_to_folder parameter is True,
quite useful if a lot of data sets are to be printed fast.
If a path is given, this is used. If a string like the (Default) “result_figures” is given,
then a subfolder of this name will be used (an generated if necessary)
relative to self.path. Use and empty string to use the self.path
If set to None, the location of the plot_func will be used and
a subfolder with title “result_figures” be generated here</p></li>
<li><p><strong>savetype</strong> (<em>str</em><em> or </em><em>iterable</em><em> (</em><em>of str</em><em>)</em><em>, </em><em>optional</em>) – matplotlib allows the saving of figures in various formats. (Default) “png”,
typical and recommendable options are “svg” and “pdf”.</p></li>
<li><p><strong>evaluation_style</strong> (<em>bool</em><em>, </em><em>optional</em>) – True (Default = False) adds a lot of extra information in the plot</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – “title=None” is in general the filename that was loaded. Setting a
specific title will be used in all plots. To remove the title all
together set an empty string with title=””</p></li>
<li><p><strong>scale_type</strong> (<em>str</em><em>, </em><em>optional</em>) – refers to the time-axis and takes, ’symlog’ (Default)(linear around zero and logarithmic otherwise)
and ‘lin’ for linear and  ‘log’ for logarithmic, switching all the time axis to this type</p></li>
<li><p><strong>patches</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False (Default) the names “measured” “fitted” “difference” will be placed above the images.
If True, then they will be included into the image (denser)</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – offers to replace the base-name used for all plots (to e.g.~specify what sample was used).
if (Default) None is used, the self.filename is used as a base name. The filename plays only a
role during saving, as does the path and savetype</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>save_figures_to_folder<span class="classifier">bool, optional</span></dt><dd><p>(Default) is True, if True the Figures are automatically saved</p>
</dd>
<dt>log_scale<span class="classifier">bool, optional</span></dt><dd><p>If True (Default), The 2D plots (Matrix) is plotted with a pseudo logarithmic intensity scale.
This usually does not give good results unless the intensity scale is symmetric</p>
</dd>
<dt>subplot<span class="classifier">bool, optional</span></dt><dd><p>If False (Default) axis labels and such are set. If True, we plot into the same axis and
do not set labels</p>
</dd>
<dt>color_offset<span class="classifier">int, optional</span></dt><dd><p>At the (Default) 0 the colours are chose from the beginning, for a larger value Color_offset
colors are skipped. Usually only used if multiple plots are created, and the data/or fit is
only shown for some of them.</p>
</dd>
<dt>lintresh<span class="classifier">float</span></dt><dd><p>The pseudo logratihmic range “symlog” is used for most time axis. Symlog plots a range around
time zero linear and beyond this linear treshold ‘lintresh’ on a logarithmic scale. (Default) 1</p>
</dd>
<dt>rel_time<span class="classifier">float or list/vector (of floats), optional</span></dt><dd><p>For each entry in rel_time a spectrum is plotted. If time_width_percent=0 (Default) the
nearest measured timepoint is chosen. For other values see ‘time_width_percent’</p>
</dd>
<dt>time_width_percent<span class="classifier">float</span></dt><dd><p>“rel_time” and “time_width_percent” work together for creating spectral plots at
specific timepoints. For each entry in rel_time a spectrum is plotted.
If however e.g. time_width_percent=10 the region between the timepoint closest
to the  1.1 x timepoint and 0.9 x timepoint is averaged and shown
(and the legend adjusted accordingly). This is particularly useful for the densly
sampled region close to t=0. Typically for a logarithmic recorded kinetics, the
timepoints at later times will be further appart than 10 percent of the value,
but this allows to elegantly combine values around time=0 for better statistics.
This averaging is only applied for the plotting function and not for the fits.</p>
</dd>
<dt>ignore_time_region<span class="classifier">None or list (of two floats or of lists), optional</span></dt><dd><p>cut set a time range with a low and high limit from the fits. (Default) None nothing happens
The region will be removed during the fitting process (and will be missing in the fit-result
plots)
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p>
</dd>
<dt>width<span class="classifier">float, optional</span></dt><dd><p>the width used in kinetics, see below (Default) 10nm</p>
</dd>
<dt>rel_wave<span class="classifier">float or list (of floats), optional</span></dt><dd><p>‘rel_wave’ and ‘width’ (in the object called ‘wavelength_bin’ work together for the creation
of kinetic plots. When plotting kinetic spectra one line will be plotted for each entrance
in the list/vector rel_wave. During object generation the vector np.arange(300,1000,100)
is set as standard. Another typical using style would be to define a list of interesting
wavelength at which a kinetic development is to be plotted. At each selected wavelength
the data between wavelength+ta.wavelength_bin and wavelength-ta.wavelength_bin is averaged
for each timepoint returned</p>
</dd>
<dt>timelimits<span class="classifier">None or list (of 2 floats), optional</span></dt><dd><p>cut times at the low and high time limit. (Default) None uses the limits of measurement
Important: If either the background or the chirp is to be fit this must include the
time before zero! Useful: It is useful to work on different regions, starting with
the longest (then use the ta.Backgound function prior to fit) and expand from there</p>
</dd>
<dt>scattercut<span class="classifier">None or iterable (of floats or other iterable, always pairs!), optional</span></dt><dd><p>intented to “cut” one or multiple scatter regions. (if (Default) None nothing
happens) If it is set the spectral region between the limits is set to zero.
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p>
</dd>
<dt>bordercut<span class="classifier">None or iterable (with two floats), optional</span></dt><dd><p>cut spectra at the low and high wavelength limit. (Default) None
uses the limits of measurement</p>
</dd>
<dt>wave_nm_bin<span class="classifier">None or float, optional</span></dt><dd><p>rebins the original data into even intervals. If set to None the original data will be used.
If set to a width (e.g. 2nm), the wavelength axis will be divided into steps of this size
and the mean of all measurements in the interval is taken. The re-binning stops as soon as
the measured stepsize is wider than given here, then the original bins are used.
This function is particularly useful for spectrometer with non-linear dispersion,
like a prism in the infrared.</p>
</dd>
<dt>intensity_range<span class="classifier">None, float or list [of two floats]</span></dt><dd><p>intensity_range is a general switch that governs what intensity range the plots show.
For the 1d plots this is the y-axis for the 2d-plots this is the colour scale.
This parameter recognizes three settings. If set to “None” (Default) this uses the minimum and
maximum of the data. A single value like in the example below and the intended use is the symmetric
scale while a list with two entries an assymmetric scale e.g.
intensity_range=3e-3 is converted into intensity_range=[-3e-3,3e-3]</p>
</dd>
<dt>baseunit<span class="classifier">str</span></dt><dd><p>baseunit is a neat way to change the unit on the time axis of the plots. (Default) ‘ps’, but they
can be frames or something similarly. This is changing only the label of the axis.
During the import there is the option to divide the numbers by a factor.
I have also used frames or fs as units. Important is that all time units will be labeled with
this unit.</p>
</dd>
<dt>f<span class="classifier">str</span></dt><dd><p>f is a replacement title that is set instead of the title. mainly used to have some options
(Default) is ‘standard’</p>
</dd>
<dt>log_fit<span class="classifier">bool, optional</span></dt><dd><p>(default)= False Used for legend generation, tells if the fit was in log or lin space</p>
</dd>
<dt>mod<span class="classifier">str, optional</span></dt><dd><p>Used for legend generation, tells what model was used for fitting</p>
</dd>
<dt>cmap<span class="classifier">None or matplotlib color map, optional</span></dt><dd><p>is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p>
</dd>
<dt>print_click_position<span class="classifier">bool, optional</span></dt><dd><p>if True then the click position is printed for the spectral plots</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">plot_fit_output</span><span class="p">(</span><span class="n">ta</span><span class="o">.</span><span class="n">re</span><span class="p">,</span><span class="n">ta</span><span class="o">.</span><span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="plot_func.plot_raw">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">plot_raw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plotting</span><span class="o">=</span><span class="default_value">range(0, 4)</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">intensity_range</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">baseunit</span><span class="o">=</span><span class="default_value">'ps'</span></em>, <em class="sig-param"><span class="n">timelimits</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scattercut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bordercut</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wave_nm_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">rel_wave</span><span class="o">=</span><span class="default_value">array([400, 500, 600, 700, 800])</span></em>, <em class="sig-param"><span class="n">rel_time</span><span class="o">=</span><span class="default_value">[1, 5, 10]</span></em>, <em class="sig-param"><span class="n">time_width_percent</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">ignore_time_region</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_bin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">color_offset</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">log_scale</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_type</span><span class="o">=</span><span class="default_value">'symlog'</span></em>, <em class="sig-param"><span class="n">lintresh</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_figures_to_folder</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">savetype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">print_click_position</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">data_type</span><span class="o">=</span><span class="default_value">'differential Absorption in $\\mathregular{\\Delta OD}$'</span></em>, <em class="sig-param"><span class="n">plot_second_as_energy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'nm'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#plot_raw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.plot_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the extended plot function, for convenient object based plotting see TA.Plot_RAW
This function plotts of various RAW (non fitted) plots. Based on the DataFrame ds a number of
cuts are created using the shaping parameters explained below.
In all plots the RAW data is plotted as dots and interpolated with lines
(using Savitzky-Golay window=5, order=3 interpolation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>DataFrame</em>) – This dataframe contains the data to be plotted. It is copied and sliced into the
regions defined. The dataframe expects the time to be in Index and the wavelength/energy
to be in the columns. The spectra is plotted with a second (energy) axis</p></li>
<li><p><strong>plotting</strong> (<em>int</em><em> or </em><em>iterable</em><em> (</em><em>of integers</em><em>)</em><em>, </em><em>optional</em>) – <p>This parameter determines which figures are plotted
the figures can be called separately with plotting = 1
or with a list of plots (Default) e.g.plotting=range(4) calls plots 0,1,2,3
The plots have the following numbers:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li><p>Matrix</p></li>
<li><p>Kinetics</p></li>
<li><p>Spectra</p></li>
<li><p>SVD</p></li>
</ol>
</div></blockquote>
</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em>) – title to be used on top of each plot
The (Default) None triggers  self.filename to be used. Setting a specific title as string will
be used in all plots. To remove the title all together set an empty string with this command title=””</p></li>
<li><p><strong>intensity_range</strong> (<em>None</em><em>, </em><em>float</em><em> or </em><em>list</em><em> [</em><em>of two floats</em><em>]</em>) – intensity_range is a general switch that governs what intensity range the plots show.
For the 1d plots this is the y-axis for the 2d-plots this is the colour scale.
This parameter recognizes three settings. If set to “None” (Default) this uses the minimum and
maximum of the data. A single value like in the example below and the intended use is the symmetric
scale while a list with two entries an assymmetric scale e.g.
intensity_range=3e-3 is converted into intensity_range=[-3e-3,3e-3]</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – this is the datatype and effectively the unit put on the intensity axis
(Default)’differential Absorption in $mathregular{Delta OD}$</p></li>
<li><p><strong>baseunit</strong> (<em>str</em>) – baseunit is a neat way to change the unit on the time axis of the plots. (Default) “ps”, but they
can be frames or something similarly. This is changing only the label of the axis.
During the import there is the option to divide the numbers by a factor.
I have also used frames or fs as units. Important is that all time units will be labeled with
this unit.</p></li>
<li><p><strong>timelimits</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of 2 floats</em><em>)</em><em>, </em><em>optional</em>) – cut times at the low and high time limit. (Default) None uses the limits of measurement
Important: If either the background or the chirp is to be fit this must include the
time before zero! Useful: It is useful to work on different regions, starting with
the longest (then use the ta.Backgound function prior to fit) and expand from there</p></li>
<li><p><strong>scattercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>of floats</em><em> or </em><em>other iterable</em><em>, </em><em>always pairs!</em><em>)</em><em>, </em><em>optional</em>) – intented to “cut” one or multiple scatter regions. (if (Default) None nothing
happens) If it is set the spectral region between the limits is set to zero.
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>bordercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>with two floats</em><em>)</em><em>, </em><em>optional</em>) – cut spectra at the low and high wavelength limit. (Default) None
uses the limits of measurement</p></li>
<li><p><strong>wave_nm_bin</strong> (<em>None</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – rebins the original data into even intervals. If set to None the original data will be used.
If set to a width (e.g. 2nm), the wavelength axis will be divided into steps of this size
and the mean of all measurements in the interval is taken. The re-binning stops as soon as
the measured stepsize is wider than given here, then the original bins are used.
This function is particularly useful for spectrometer with non-linear dispersion,
like a prism in the infrared.</p></li>
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – the width used in kinetics, see below (Default) 10nm</p></li>
<li><p><strong>rel_wave</strong> (<em>float</em><em> or </em><em>list</em><em> (</em><em>of floats</em><em>)</em><em>, </em><em>optional</em>) – “rel_wave” and “width” (in the object called “wavelength_bin” work together for the creation
of kinetic plots. When plotting kinetic spectra one line will be plotted for each entrance
in the list/vector rel_wave. During object generation the vector np.arange(300,1000,100)
is set as standard. Another typical using style would be to define a list of interesting
wavelength at which a kinetic development is to be plotted. At each selected wavelength
the data between wavelength+ta.wavelength_bin and wavelength-ta.wavelength_bin is averaged
for each timepoint returned</p></li>
<li><p><strong>rel_time</strong> (<em>float</em><em> or </em><em>list/vector</em><em> (</em><em>of floats</em><em>)</em><em>, </em><em>optional</em>) – For each entry in rel_time a spectrum is plotted. If time_width_percent=0 (Default) the
nearest measured timepoint is chosen. For other values see “time_width_percent”</p></li>
<li><p><strong>time_width_percent</strong> (<em>float</em>) – “rel_time” and “time_width_percent” work together for creating spectral plots at
specific timepoints. For each entry in rel_time a spectrum is plotted.
If however e.g. time_width_percent=10 the region between the timepoint closest
to the  1.1 x timepoint and 0.9 x timepoint is averaged and shown
(and the legend adjusted accordingly). This is particularly useful for the densly
sampled region close to t=0. Typically for a logarithmic recorded kinetics, the
timepoints at later times will be further appart than 10 percent of the value,
but this allows to elegantly combine values around time=0 for better statistics.
This averaging is only applied for the plotting function and not for the fits.</p></li>
<li><p><strong>ignore_time_region</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of two floats</em><em> or </em><em>of lists</em><em>)</em><em>, </em><em>optional</em>) – cut set a time range with a low and high limit from the fits. (Default) None nothing happens
The region will be removed during the fitting process (and will be missing in the fit-result
plots)
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>time_bin</strong> (<em>None</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – is dividing the points on the time-axis in even bins and averages the found values in between.
This is a hard approach that also affects the fits. I do recommend to use this carefully,
it is most useful for modulated data. A better choice for transient absorption that only
affects the kinetics is “time_width_percent”</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g. your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
<li><p><strong>color_offset</strong> (<em>int</em><em>, </em><em>optional</em>) – At the (Default) 0 the colours are chose from the beginning, for a larger value Color_offset
colors are skipped. Usually only used if multiple plots are created, and the data/or fit is
only shown for some of them.</p></li>
<li><p><strong>log_scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True (Default), The 2D plots (Matrix) is plotted with a pseudo logarithmic intensity scale.
This usually does not give good results unless the intensity scale is symmetric</p></li>
<li><p><strong>Scale_type</strong> (<em>None</em><em> or </em><em>str</em>) – is a general setting that can influences what time axis will be used for the plots.
“symlog” (linear around zero and logarithmic otherwise) “lin” and “log” are valid options.</p></li>
<li><p><strong>lintresh</strong> (<em>float</em>) – The pseudo logratihmic range “symlog” is used for most time axis. Symlog plots a range around
time zero linear and beyond this linear treshold ‘lintresh’ on a logarithmic scale. (Default) 0.3</p></li>
<li><p><strong>times</strong> (<em>None</em><em> or </em><em>int</em>) – are the number of components to be used in the SVD (Default) is None (which is seen as 6)</p></li>
<li><p><strong>save_figures_to_folder</strong> (<em>bool</em><em>, </em><em>optional</em>) – (Default) is False, if True the Figures are automatically saved</p></li>
<li><p><strong>savetype</strong> (<em>str</em><em> or </em><em>iterable</em><em> (</em><em>of str</em><em>)</em><em>, </em><em>optional</em>) – matplotlib allows the saving of figures in various formats. (Default) “png”,
typical and recommendable options are “svg” and “pdf”.</p></li>
<li><p><strong>path</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>path object</em><em>, </em><em>optional</em>) – This defines where the files are saved if the safe_figures_to_folder parameter is True,
quite useful if a lot of data sets are to be printed fast.
If a path is given, this is used. If a string like the (Default) “result_figures” is given,
then a subfolder of this name will be used (an generated if necessary)
relative to self.path. Use and empty string to use the self.path
If set to None, the location of the plot_func will be used and
a subfolder with title “result_figures” be generated here</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – offers to replace the base-name used for all plots (to e.g.~specify what sample was used).
if (Default) None is used, the self.filename is used as a base name. The filename plays only a
role during saving, as does the path and savetype</p></li>
<li><p><strong>print_click_position</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True then the click position is printed for the spectral plots</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.plot_time">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">plot_time</code><span class="sig-paren">(</span><em class="sig-param">ds</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">rel_time=None</em>, <em class="sig-param">time_width_percent=10</em>, <em class="sig-param">ignore_time_region=None</em>, <em class="sig-param">wave_nm_bin=None</em>, <em class="sig-param">title=None</em>, <em class="sig-param">text_in_legend=None</em>, <em class="sig-param">baseunit='ps'</em>, <em class="sig-param">lines_are='smoothed'</em>, <em class="sig-param">scattercut=None</em>, <em class="sig-param">bordercut=None</em>, <em class="sig-param">subplot=False</em>, <em class="sig-param">linewidth=1</em>, <em class="sig-param">color_offset=0</em>, <em class="sig-param">intensity_range=None</em>, <em class="sig-param">plot_second_as_energy=True</em>, <em class="sig-param">cmap=&lt;matplotlib.colors.ListedColormap object&gt;</em>, <em class="sig-param">data_type='differential Absorption in $\\mathregular{\\Delta OD}$'</em>, <em class="sig-param">units='nm'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#plot_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.plot_time" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Function to create plots at a certain time. In general you give under rel_time a</dt><dd><p>list of times at which yu do want to plot the time width percentage means that
this function integrates ewverything plus minus 10% at this time. lines_are is a
switch that regulates what is plotted. data plots the data only,
smoothed plots the data and a smoothed version of the data, fitted plots only the fit.
the subplot switch is for using this to plot e.g. multiple different datasets.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>DataFrame</em>) – This dataframe contains the data to be plotted. It is copied and sliced into the
regions defined. The dataframe expects the time to be in Index and the wavelength/energy
to be in the columns. The spectra is plotted with a second (energy) axis</p></li>
<li><p><strong>ax</strong> (<em>None</em><em> or </em><em>matplotlib axis object</em><em>, </em><em>optional</em>) – if None (Default), a figure and axis will be generated for the plot, if axis is given the plot will
placed in there.</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – this is the datatype and effectively the unit put on the intensity axis
(Default)’differential Absorption in $mathregular{Delta OD}$</p></li>
<li><p><strong>rel_time</strong> (<em>float</em><em> or </em><em>list/vector</em><em> (</em><em>of floats</em><em>)</em><em>, </em><em>optional</em>) – For each entry in rel_time a spectrum is plotted. If time_width_percent=0 (Default) the
nearest measured timepoint is chosen. For other values see ‘time_width_percent’</p></li>
<li><p><strong>time_width_percent</strong> (<em>float</em>) – “rel_time” and “time_width_percent” work together for creating spectral plots at
specific timepoints. For each entry in rel_time a spectrum is plotted.
If however e.g. time_width_percent=10 the region between the timepoint closest
to the  1.1 x timepoint and 0.9 x timepoint is averaged and shown
(and the legend adjusted accordingly). This is particularly useful for the densly
sampled region close to t=0. Typically for a logarithmic recorded kinetics, the
timepoints at later times will be further appart than 10 percent of the value,
but this allows to elegantly combine values around time=0 for better statistics.
This averaging is only applied for the plotting function and not for the fits.</p></li>
<li><p><strong>ignore_time_region</strong> (<em>None</em><em> or </em><em>list</em><em> (</em><em>of two floats</em><em> or </em><em>of lists</em><em>)</em><em>, </em><em>optional</em>) – cut set a time range with a low and high limit from the fits. (Default) None nothing happens
The region will be removed during the fitting process (and will be missing in the fit-result
plots)
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>wave_nm_bin</strong> (<em>None</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – rebins the original data into even intervals. If set to None the original data will be used.
If set to a width (e.g. 2nm), the wavelength axis will be divided into steps of this size
and the mean of all measurements in the interval is taken. The re-binning stops as soon as
the measured stepsize is wider than given here, then the original bins are used.
This function is particularly useful for spectrometer with non-linear dispersion,
like a prism in the infrared.</p></li>
<li><p><strong>title</strong> (<em>None</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – title to be used on top of each plot
The (Default) None triggers  self.filename to be used. Setting a specific title as string will
be used in all plots. To remove the title all together set an empty string with this command title=””</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – linewidth to be used for plotting</p></li>
<li><p><strong>text_in_legend</strong> (<em>str</em><em>, </em><em>optional</em>) – text to be used in legend before the actually lines and colours (set as heasder)</p></li>
<li><p><strong>baseunit</strong> (<em>str</em>) – baseunit is a neat way to change the unit on the time axis of the plots. (Default) ‘ps’, but they
can be frames or something similarly. This is changing only the label of the axis.
During the import there is the option to divide the numbers by a factor.
I have also used frames or fs as units. Important is that all time units will be labeled with
this unit.</p></li>
<li><p><strong>scattercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>of floats</em><em> or </em><em>other iterable</em><em>, </em><em>always pairs!</em><em>)</em><em>, </em><em>optional</em>) – intented to “cut” one or multiple scatter regions. (if (Default) None nothing
happens) If it is set the spectral region between the limits is set to zero.
Usage single region: [lower region limit,upper region limit],
use for multiple regions:[[lower limit 1,upper limit 1],[lower limit 2,upper limit 2],…]</p></li>
<li><p><strong>bordercut</strong> (<em>None</em><em> or </em><em>iterable</em><em> (</em><em>with two floats</em><em>)</em><em>, </em><em>optional</em>) – cut spectra at the low and high wavelength limit. (Default) None
uses the limits of measurement</p></li>
<li><p><strong>; bool</strong> (<em>subplot</em>) – False (Default) means this is a main plot in this axis! if True then this is the second plot in the axis
and things like axis ticks should not be reset
this also avoids adding the object to the legend</p></li>
<li><p><strong>optional</strong> – False (Default) means this is a main plot in this axis! if True then this is the second plot in the axis
and things like axis ticks should not be reset
this also avoids adding the object to the legend</p></li>
<li><p><strong>color_offset</strong> (<em>int</em><em>, </em><em>optional</em>) – At the (Default) 0 the colours are chose from the beginning, for a larger value Color_offset
colors are skipped. Usually only used if multiple plots are created, and the data/or fit is
only shown for some of them.</p></li>
<li><p><strong>intensity_range</strong> (<em>None</em><em>, </em><em>float</em><em> or </em><em>list</em><em> [</em><em>of two floats</em><em>]</em>) – intensity_range is a general switch that governs what intensity range the plots show.
For the 1d plots this is the y-axis for the 2d-plots this is the colour scale.
This parameter recognizes three settings. If set to “None” (Default) this uses the minimum and
maximum of the data. A single value like in the example below and the intended use is the symmetric
scale while a list with two entries an assymmetric scale e.g.
intensity_range=3e-3 is converted into intensity_range=[-3e-3,3e-3]</p></li>
<li><p><strong>plot_second_as_energy</strong> (<em>bool</em><em>, </em><em>optional</em>) – For (Default) True a second x-axis is plotted  with “eV” as unit</p></li>
<li><p><strong>cmap</strong> (<em>None</em><em> or </em><em>matplotlib color map</em><em>, </em><em>optional</em>) – is a powerfull variable that chooses the colour map applied for all plots. If set to
None (Default) then the self.cmap is used.
As standard I use the color map “jet” from matplotlib. There are a variety of colormaps
available that are very usefull. Beside “jet”, “viridis” is a good choice as it is well
visible under red-green blindness. Other useful maps are “prism” for high fluctuations
or diverging color maps like “seismic”.
See <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html">https://matplotlib.org/3.1.0/tutorials/colors/colormaps.html</a> for a comprehensive
selection. In the code the colormaps are imported so if plot_func is imported as pf then
self.cmap=pf.cm.viridis sets viridis as the map to use. Internally the colors are chosen
with the “colm” function. The 2d plots require a continuous color map so if something
else is give 2d plots are shown automatically with “jet”. For all of the 1d plots however
I first select a number of colors before each plot. If cmap is a continous map then these
are sampled evenly over the colourmap. Manual iterables of colours
cmap=[(1,0,0),(0,1,0),(0,0,1),…] are also accepted, as are vectors or dataframes that
contain as rows the colors. There must be of course sufficient colors present for
the numbers of lines that will be plotted. So I recommend to provide at least 10 colours
(e.g.~your university colors). colours are always given as a, list or tuple with RGA or RGBA
(with the last A beeing the Alpha=transparency. All numbers are between 0 and 1.
If a list/vector/DataFrame is given for the colours they will be used in the order provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="plot_func.s2_vs_smin2">
<code class="sig-prename descclassname">plot_func.</code><code class="sig-name descname">s2_vs_smin2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Spectral_points</span><span class="o">=</span><span class="default_value">512</span></em>, <em class="sig-param"><span class="n">Time_points</span><span class="o">=</span><span class="default_value">130</span></em>, <em class="sig-param"><span class="n">number_of_species</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">fitted_kinetic_pars</span><span class="o">=</span><span class="default_value">7</span></em>, <em class="sig-param"><span class="n">target_quality</span><span class="o">=</span><span class="default_value">0.95</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_func.html#s2_vs_smin2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_func.s2_vs_smin2" title="Permalink to this definition">¶</a></dt>
<dd><p>dfn is numerator and number of fitted parameters, dfd is denominator and number of degrees of freedom,
F-test is deciding if a set of parameters gives a statistical significant difference. T-test is if a single parameter gives      statistical difference.
Null hypothesis, all parameter are zero, if significant, the coefficients improve the fit
the f-statistics compares the number of
“fitted parameter”=number of species*number of spectral points + number of kinetic parameter
“free points”=number of species*number of spectral points*number of time points - fitted parameter
within the target quality, meaning, what fraction do my variances need to have, so that I’m 100% * target_quality sure that they are different from zero</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="genindex.html" class="btn btn-neutral float-left" title="Function Index" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Jens Uhlig.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>